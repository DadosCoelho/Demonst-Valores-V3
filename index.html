<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Visão Financeira Calculada</title>
    <link rel="icon" type="image/png" href="https://cdn-icons-png.flaticon.com/512/4598/4598376.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Estilos copiados da V1 e V3 e ajustados */
        body {
            font-family: sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f7f7f7;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }

        /* Estilos de célula e linha */
        .cell-box {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        /* Classes para seleção */
        .cell-selecionada {
            background-color: #fff9aa !important; /* Fundo amarelo claro */
        }
        .cabecalho-selecionado, .indicador-selecionado {
            background: #60a5fa !important; /* Fundo azul claro */
            color: #fff;
        }

        .header-box {
            text-align: center;
        }
        /* A classe indicador-col agora se aplica à coluna Descrição na tbody */
        .indicador-col {
            background-color: #F9FAFB; /* Fundo cinza claro */
            width: 330px; /* Largura da coluna de descrição */
        }
        .grande {
            font-size: 1rem;
        }
        .linha-azul { /* Estilo de linha da V1 (pode ser usado opcionalmente) */
            background-color: #DBEAFE;
        }
        .linha-azul-escuro { /* Estilo de linha da V1 (pode ser opcionalmente) */
            background-color: #93C5FD;
        }

        /* Estilos da tabela */
        table {
            border-collapse: collapse;
            width: 100%;
            margin-top: 20px;
            background-color: #fff;
            border-radius: 8px;
            /* REMOVIDO: overflow: hidden; - para que sticky funcione */
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        th, td {
            border: 1px solid #ddd;
            padding: 10px 8px;
            text-align: left;
        }
        /* Estilo para o cabeçalho da tabela (thead) */
        thead tr {
            background-color: #60a5fa; /* Azul da V1 para o cabeçalho */
            color: white;
        }
        th {
            font-weight: bold;
            text-transform: uppercase;
            position: sticky; /* Torna os cabeçalhos fixos ao rolar verticalmente */
            top: 0;
            z-index: 1; /* Garante que os cabeçalhos fiquem acima do conteúdo */
            background-color: #e0e0e0; /* Garante que o fundo do cabeçalho seja azul mesmo com sticky */
            color: #333;
        }
        /* ESTILO NOVO/MODIFICADO: Coluna 'Descrição' no Cabeçalho */
        thead th:first-child {
            background-color: #e0e0e0; /* Cinza da V3 para cabeçalho secundário */
            color: #333; /* Cor de texto da V3 */
            position: sticky; /* Torna a primeira coluna fixa ao rolar horizontalmente */
            left: 0;
            z-index: 2; /* Z-index mais alto para ficar acima de outros cabeçalhos sticky */
        }

        /* ESTILO NOVO: Largura mínima e não quebrar linha para os cabeçalhos de período (todas as THs exceto a primeira) */
        thead th:not(:first-child) { 
            min-width: 100px; /* Valor mínimo para garantir que o texto não quebre, ajuste conforme necessário */
            white-space: nowrap; /* Impede que o texto quebre em várias linhas */
        }


        /* ESTILO MODIFICADO: Coluna 'Descrição' no Corpo da Tabela */
        td.account-descricao { /* Coluna Descrição na tbody */
            position: sticky; /* Torna a célula da descrição fixa ao rolar horizontalmente */
            left: 0;
            z-index: 1; /* Garante que ela fique acima das células de dados que rolam */
            background-color: #F9FAFB; /* Fundo para evitar 'ghosting' ao rolar */
            /* REMOVIDO: white-space: nowrap; - agora no span interno */
            /* Indentação será aplicada via classes CSS */
            display: flex; /* Permite que o ícone de toggle e o texto fiquem na mesma linha */
            align-items: center; /* Alinha verticalmente ícone e texto */
        }
        
        /* NOVO ESTILO: Para o span que contém o texto da descrição (ajuste para reticências) */
        td.account-descricao > span:last-child { 
            margin-left: 5px;
            white-space: nowrap; /* Impede a quebra de linha */
            overflow: hidden;     /* Oculta o conteúdo que excede o limite */
            text-overflow: ellipsis; /* Adiciona "..." se o texto for truncado */
            flex-grow: 1; /* Permite que o span cresça para preencher o espaço disponível */
            flex-shrink: 1; /* Permite que o span encolha se necessário */
            min-width: 0; /* Permite que o flex item encolha abaixo do seu tamanho de conteúdo, essencial com overflow: hidden */
        }

        /* Classes de indentação */
        .indent-level-0 { padding-left: 10px; }
        .indent-level-1 { padding-left: 25px; }
        .indent-level-2 { padding-left: 40px; }
        .indent-level-3 { padding-left: 55px; }
        .indent-level-4 { padding-left: 70px; }
        .indent-level-5 { padding-left: 85px; }

        /* Estilos para linhas de contas por tipo (V3) */
        .conta-sintetica td {
            font-weight: bold; /* Sintéticas permanecem em negrito */
        }
        .conta-analitica {
            /* As contas analíticas não terão negrito, pois a regra geral de td.account-descricao foi removida */
        }
        .conta-calculo td {
            font-weight: bold; /* Contas de cálculo (nível 1) em negrito */
            font-style: italic;
            border-top: 1px solid #93C5FD; /* Linha acima de contas de cálculo */
        }

        /* Estilos para células de valor (V3) */
        .value-cell { /* Células de dados na tbody */
            text-align: right;
            white-space: nowrap;
            font-family: monospace;
        }
        .negative-value {
            color: #d32f2f;
        }

        /* Estilo para o seletor de visão (V3) */
        .view-selector {
            margin-bottom: 20px;
            background-color: #fff;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .view-selector label {
            font-weight: bold;
            margin-right: 10px;
        }
        .view-selector select {
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 1rem;
        }

        /* Container para scrolagem horizontal da tabela (V3) */
        .table-container {
            overflow-x: auto; /* Permite rolagem horizontal */
            margin-top: 20px;
        }

        /* --- NOVOS ESTILOS PARA EXPANDIR/COLAPSAR --- */
        .toggle-arrow {
            cursor: pointer;
            display: inline-block;
            transition: transform 0.1s ease-in-out;
            font-size: 0.8em; /* Levemente menor para não destoar */
            vertical-align: middle; /* Alinha com o texto */
            user-select: none; /* Impede a seleção do texto da seta */
            width: 1em; /* Garante que o ícone tenha um tamanho clicável consistente */
            text-align: center;
        }
        /* Rotaciona a seta para a direita quando a linha está colapsada (indicando "expandir") */
        .collapsible-row.collapsed > td .toggle-arrow {
            transform: rotate(-90deg);
        }
        /* Seta para baixo quando a linha está expandida (estado padrão, quando .collapsed não está presente) */
        .collapsible-row:not(.collapsed) > td .toggle-arrow { 
            transform: rotate(0deg);
        }
        /* Oculta as linhas que devem estar escondidas por colapso */
        .hidden-by-collapse {
            display: none;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">
    <div class="container mx-auto px-4 py-8">
        <!-- Título principal fora da tabela -->
        <h1 class="text-2xl font-bold mb-4">Demonstração Financeira Calculada</h1>

        <!-- Subtítulo para a visão selecionada -->
        <h2 id="view-title" class="text-xl font-semibold mb-6">Selecione uma Visão para Visualizar...</h2>

        <div class="flex items-center mb-6 view-selector">
            <label for="view-select">Selecionar Visão:</label>
            <select id="view-select"></select>
        </div>

        <div class="table-container">
            <table id="tabela" class="min-w-full bg-white rounded-xl shadow-md border">
                <thead>
                    <!-- A linha de cabeçalho será adicionada pelo JS -->
                    <tr></tr>
                </thead>
                <tbody>
                    <!-- As linhas de dados serão preenchidas via JS -->
                </tbody>
            </table>
        </div>

    </div>

    <script>
        // Variável que será substituída pelo script Python processar_dados.py
        // Por padrão, deixamos ela com uma estrutura vazia para que o arquivo HTML seja um template.
        // O script Python injetará os dados reais aqui, substituindo este conteúdo.
        const calculatedViewsData = {
    "calculated_views": [
        {
            "plan_name": "SERVISE",
            "data_source_name": "GRUPO GOLEIRO",
            "periodos": [
                "2025-01-01 00:00:00",
                "2025-02-01 00:00:00",
                "2025-03-01 00:00:00",
                "2025-04-01 00:00:00",
                "2025-05-01 00:00:00",
                "2025-06-01 00:00:00"
            ],
            "accounts": [
                {
                    "codigo": "001",
                    "descricao": "Receita Bruta",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 11898.82,
                        "2025-02-01 00:00:00": 14062.240000000002,
                        "2025-03-01 00:00:00": 12439.649999999998,
                        "2025-04-01 00:00:00": 7752.259999999999,
                        "2025-05-01 00:00:00": 13521.380000000001,
                        "2025-06-01 00:00:00": 8202.97
                    },
                    "nivel": 1
                },
                {
                    "codigo": "001.01",
                    "descricao": "Receita sobre Serviços",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 11898.82,
                        "2025-02-01 00:00:00": 14062.240000000002,
                        "2025-03-01 00:00:00": 12439.649999999998,
                        "2025-04-01 00:00:00": 7752.259999999999,
                        "2025-05-01 00:00:00": 13521.380000000001,
                        "2025-06-01 00:00:00": 8202.97
                    },
                    "nivel": 2
                },
                {
                    "codigo": "001.01.01",
                    "descricao": "Receita de Projetos de Software",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 2505.0200000000004,
                        "2025-02-01 00:00:00": 2960.4700000000003,
                        "2025-03-01 00:00:00": 2618.87,
                        "2025-04-01 00:00:00": 1632.06,
                        "2025-05-01 00:00:00": 2846.6000000000004,
                        "2025-06-01 00:00:00": 1726.94
                    },
                    "nivel": 3
                },
                {
                    "codigo": "001.01.01.0001",
                    "descricao": "Desenvolvimento sob demanda",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 2505.0200000000004,
                        "2025-02-01 00:00:00": 2960.4700000000003,
                        "2025-03-01 00:00:00": 2618.87,
                        "2025-04-01 00:00:00": 1632.06,
                        "2025-05-01 00:00:00": 2846.6000000000004,
                        "2025-06-01 00:00:00": 1726.94
                    },
                    "nivel": 4
                },
                {
                    "codigo": "001.01.02",
                    "descricao": "Receita de Manutenção e Suporte",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 3594.15,
                        "2025-02-01 00:00:00": 4247.63,
                        "2025-03-01 00:00:00": 3757.52,
                        "2025-04-01 00:00:00": 2341.64,
                        "2025-05-01 00:00:00": 4084.27,
                        "2025-06-01 00:00:00": 2477.79
                    },
                    "nivel": 3
                },
                {
                    "codigo": "001.01.02.0001",
                    "descricao": "Suporte técnico mensal",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 898.54,
                        "2025-02-01 00:00:00": 1061.91,
                        "2025-03-01 00:00:00": 939.38,
                        "2025-04-01 00:00:00": 585.41,
                        "2025-05-01 00:00:00": 1021.07,
                        "2025-06-01 00:00:00": 619.45
                    },
                    "nivel": 4
                },
                {
                    "codigo": "001.01.02.0002",
                    "descricao": "Atualizações e correções",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 2695.61,
                        "2025-02-01 00:00:00": 3185.72,
                        "2025-03-01 00:00:00": 2818.14,
                        "2025-04-01 00:00:00": 1756.23,
                        "2025-05-01 00:00:00": 3063.2,
                        "2025-06-01 00:00:00": 1858.34
                    },
                    "nivel": 4
                },
                {
                    "codigo": "001.01.03",
                    "descricao": "Receita de Consultoria",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 2232.73,
                        "2025-02-01 00:00:00": 2638.6800000000003,
                        "2025-03-01 00:00:00": 2334.21,
                        "2025-04-01 00:00:00": 1454.66,
                        "2025-05-01 00:00:00": 2537.19,
                        "2025-06-01 00:00:00": 1539.23
                    },
                    "nivel": 3
                },
                {
                    "codigo": "001.01.03.0001",
                    "descricao": "Consultoria técnica",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 54.46,
                        "2025-02-01 00:00:00": 64.36,
                        "2025-03-01 00:00:00": 56.93,
                        "2025-04-01 00:00:00": 35.48,
                        "2025-05-01 00:00:00": 61.88,
                        "2025-06-01 00:00:00": 37.54
                    },
                    "nivel": 4
                },
                {
                    "codigo": "001.01.03.0002",
                    "descricao": "Treinamentos e workshops",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 2178.27,
                        "2025-02-01 00:00:00": 2574.32,
                        "2025-03-01 00:00:00": 2277.28,
                        "2025-04-01 00:00:00": 1419.18,
                        "2025-05-01 00:00:00": 2475.31,
                        "2025-06-01 00:00:00": 1501.69
                    },
                    "nivel": 4
                },
                {
                    "codigo": "001.01.04",
                    "descricao": "Receita de Licenciamento",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 3566.92,
                        "2025-02-01 00:00:00": 4215.46,
                        "2025-03-01 00:00:00": 3729.05,
                        "2025-04-01 00:00:00": 2323.8999999999996,
                        "2025-05-01 00:00:00": 4053.32,
                        "2025-06-01 00:00:00": 2459.01
                    },
                    "nivel": 3
                },
                {
                    "codigo": "001.01.04.0001",
                    "descricao": "Licença mensal SaaS",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 1769.85,
                        "2025-02-01 00:00:00": 2091.64,
                        "2025-03-01 00:00:00": 1850.29,
                        "2025-04-01 00:00:00": 1153.08,
                        "2025-05-01 00:00:00": 2011.19,
                        "2025-06-01 00:00:00": 1220.12
                    },
                    "nivel": 4
                },
                {
                    "codigo": "001.01.04.0002",
                    "descricao": "Licença perpétua",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 1797.07,
                        "2025-02-01 00:00:00": 2123.82,
                        "2025-03-01 00:00:00": 1878.76,
                        "2025-04-01 00:00:00": 1170.82,
                        "2025-05-01 00:00:00": 2042.13,
                        "2025-06-01 00:00:00": 1238.89
                    },
                    "nivel": 4
                },
                {
                    "codigo": "002",
                    "descricao": "Deduções da Receita Bruta",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -4198.87,
                        "2025-02-01 00:00:00": -4962.299999999999,
                        "2025-03-01 00:00:00": -4389.73,
                        "2025-04-01 00:00:00": -2735.63,
                        "2025-05-01 00:00:00": -4771.44,
                        "2025-06-01 00:00:00": -2894.6800000000003
                    },
                    "nivel": 1
                },
                {
                    "codigo": "002.01",
                    "descricao": "Impostos sobre Receita",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -1294.81,
                        "2025-02-01 00:00:00": -1530.23,
                        "2025-03-01 00:00:00": -1353.6599999999999,
                        "2025-04-01 00:00:00": -843.5899999999999,
                        "2025-05-01 00:00:00": -1471.37,
                        "2025-06-01 00:00:00": -892.6300000000001
                    },
                    "nivel": 2
                },
                {
                    "codigo": "002.01.01",
                    "descricao": "ISS",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -18.5,
                        "2025-02-01 00:00:00": -21.86,
                        "2025-03-01 00:00:00": -19.34,
                        "2025-04-01 00:00:00": -12.05,
                        "2025-05-01 00:00:00": -21.02,
                        "2025-06-01 00:00:00": -12.75
                    },
                    "nivel": 3
                },
                {
                    "codigo": "002.01.01.0001",
                    "descricao": "ISS sobre serviços locais",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -18.5,
                        "2025-02-01 00:00:00": -21.86,
                        "2025-03-01 00:00:00": -19.34,
                        "2025-04-01 00:00:00": -12.05,
                        "2025-05-01 00:00:00": -21.02,
                        "2025-06-01 00:00:00": -12.75
                    },
                    "nivel": 4
                },
                {
                    "codigo": "002.01.02",
                    "descricao": "PIS/COFINS",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -1276.31,
                        "2025-02-01 00:00:00": -1508.3700000000001,
                        "2025-03-01 00:00:00": -1334.32,
                        "2025-04-01 00:00:00": -831.54,
                        "2025-05-01 00:00:00": -1450.35,
                        "2025-06-01 00:00:00": -879.8800000000001
                    },
                    "nivel": 3
                },
                {
                    "codigo": "002.01.02.0001",
                    "descricao": "PIS",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -850.87,
                        "2025-02-01 00:00:00": -1005.58,
                        "2025-03-01 00:00:00": -889.55,
                        "2025-04-01 00:00:00": -554.36,
                        "2025-05-01 00:00:00": -966.9,
                        "2025-06-01 00:00:00": -586.59
                    },
                    "nivel": 4
                },
                {
                    "codigo": "002.01.02.0002",
                    "descricao": "COFINS",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -425.44,
                        "2025-02-01 00:00:00": -502.79,
                        "2025-03-01 00:00:00": -444.77,
                        "2025-04-01 00:00:00": -277.18,
                        "2025-05-01 00:00:00": -483.45,
                        "2025-06-01 00:00:00": -293.29
                    },
                    "nivel": 4
                },
                {
                    "codigo": "002.02",
                    "descricao": "Devoluções e Descontos",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -2904.06,
                        "2025-02-01 00:00:00": -3432.0699999999997,
                        "2025-03-01 00:00:00": -3036.07,
                        "2025-04-01 00:00:00": -1892.04,
                        "2025-05-01 00:00:00": -3300.0699999999997,
                        "2025-06-01 00:00:00": -2002.0500000000002
                    },
                    "nivel": 2
                },
                {
                    "codigo": "002.02.01",
                    "descricao": "Descontos concedidos",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -1183.82,
                        "2025-02-01 00:00:00": -1399.06,
                        "2025-03-01 00:00:00": -1237.63,
                        "2025-04-01 00:00:00": -771.28,
                        "2025-05-01 00:00:00": -1345.25,
                        "2025-06-01 00:00:00": -816.12
                    },
                    "nivel": 3
                },
                {
                    "codigo": "002.02.01.0001",
                    "descricao": "Descontos comerciais",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -1183.82,
                        "2025-02-01 00:00:00": -1399.06,
                        "2025-03-01 00:00:00": -1237.63,
                        "2025-04-01 00:00:00": -771.28,
                        "2025-05-01 00:00:00": -1345.25,
                        "2025-06-01 00:00:00": -816.12
                    },
                    "nivel": 4
                },
                {
                    "codigo": "002.02.02",
                    "descricao": "Estornos e cancelamentos",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -1720.24,
                        "2025-02-01 00:00:00": -2033.01,
                        "2025-03-01 00:00:00": -1798.44,
                        "2025-04-01 00:00:00": -1120.76,
                        "2025-05-01 00:00:00": -1954.82,
                        "2025-06-01 00:00:00": -1185.93
                    },
                    "nivel": 3
                },
                {
                    "codigo": "002.02.02.0001",
                    "descricao": "Estorno de serviços",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -1720.24,
                        "2025-02-01 00:00:00": -2033.01,
                        "2025-03-01 00:00:00": -1798.44,
                        "2025-04-01 00:00:00": -1120.76,
                        "2025-05-01 00:00:00": -1954.82,
                        "2025-06-01 00:00:00": -1185.93
                    },
                    "nivel": 4
                },
                {
                    "codigo": "003",
                    "descricao": "Receita Líquida",
                    "tipo": "calculo (001 + 002)",
                    "formula": "001 + 002",
                    "valores": {
                        "2025-01-01 00:00:00": 7699.95,
                        "2025-02-01 00:00:00": 9099.940000000002,
                        "2025-03-01 00:00:00": 8049.919999999998,
                        "2025-04-01 00:00:00": 5016.629999999999,
                        "2025-05-01 00:00:00": 8749.940000000002,
                        "2025-06-01 00:00:00": 5308.289999999999
                    },
                    "nivel": 1
                },
                {
                    "codigo": "004",
                    "descricao": "Custos dos Serviços Prestados",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -3237.1800000000003,
                        "2025-02-01 00:00:00": -3825.75,
                        "2025-03-01 00:00:00": -3384.33,
                        "2025-04-01 00:00:00": -2109.0699999999997,
                        "2025-05-01 00:00:00": -3678.61,
                        "2025-06-01 00:00:00": -2231.7
                    },
                    "nivel": 1
                },
                {
                    "codigo": "004.01",
                    "descricao": "Mão de Obra Direta",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -3237.1800000000003,
                        "2025-02-01 00:00:00": -3825.75,
                        "2025-03-01 00:00:00": -3384.33,
                        "2025-04-01 00:00:00": -2109.0699999999997,
                        "2025-05-01 00:00:00": -3678.61,
                        "2025-06-01 00:00:00": -2231.7
                    },
                    "nivel": 2
                },
                {
                    "codigo": "004.01.01",
                    "descricao": "Salários técnicos",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -1623.8600000000001,
                        "2025-02-01 00:00:00": -1919.1100000000001,
                        "2025-03-01 00:00:00": -1697.68,
                        "2025-04-01 00:00:00": -1057.97,
                        "2025-05-01 00:00:00": -1845.3000000000002,
                        "2025-06-01 00:00:00": -1119.48
                    },
                    "nivel": 3
                },
                {
                    "codigo": "004.01.01.0001",
                    "descricao": "Desenvolvedores",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -970.1,
                        "2025-02-01 00:00:00": -1146.48,
                        "2025-03-01 00:00:00": -1014.2,
                        "2025-04-01 00:00:00": -632.03,
                        "2025-05-01 00:00:00": -1102.39,
                        "2025-06-01 00:00:00": -668.78
                    },
                    "nivel": 4
                },
                {
                    "codigo": "004.01.01.0002",
                    "descricao": "Testadores (QA)",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -653.76,
                        "2025-02-01 00:00:00": -772.63,
                        "2025-03-01 00:00:00": -683.48,
                        "2025-04-01 00:00:00": -425.94,
                        "2025-05-01 00:00:00": -742.91,
                        "2025-06-01 00:00:00": -450.7
                    },
                    "nivel": 4
                },
                {
                    "codigo": "004.01.02",
                    "descricao": "Encargos e benefícios",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -1613.3200000000002,
                        "2025-02-01 00:00:00": -1906.6399999999999,
                        "2025-03-01 00:00:00": -1686.6499999999999,
                        "2025-04-01 00:00:00": -1051.1,
                        "2025-05-01 00:00:00": -1833.31,
                        "2025-06-01 00:00:00": -1112.22
                    },
                    "nivel": 3
                },
                {
                    "codigo": "004.01.02.0001",
                    "descricao": "Encargos sociais",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -1043.91,
                        "2025-02-01 00:00:00": -1233.71,
                        "2025-03-01 00:00:00": -1091.36,
                        "2025-04-01 00:00:00": -680.12,
                        "2025-05-01 00:00:00": -1186.26,
                        "2025-06-01 00:00:00": -719.67
                    },
                    "nivel": 4
                },
                {
                    "codigo": "004.01.02.0002",
                    "descricao": "Benefícios (VR, VT, etc.)",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -569.41,
                        "2025-02-01 00:00:00": -672.93,
                        "2025-03-01 00:00:00": -595.29,
                        "2025-04-01 00:00:00": -370.98,
                        "2025-05-01 00:00:00": -647.05,
                        "2025-06-01 00:00:00": -392.55
                    },
                    "nivel": 4
                },
                {
                    "codigo": "005",
                    "descricao": "Lucro Bruto",
                    "tipo": "calculo (003 + 004)",
                    "formula": "003 + 004",
                    "valores": {
                        "2025-01-01 00:00:00": 4462.7699999999995,
                        "2025-02-01 00:00:00": 5274.190000000002,
                        "2025-03-01 00:00:00": 4665.589999999998,
                        "2025-04-01 00:00:00": 2907.5599999999995,
                        "2025-05-01 00:00:00": 5071.330000000002,
                        "2025-06-01 00:00:00": 3076.5899999999992
                    },
                    "nivel": 1
                },
                {
                    "codigo": "006",
                    "descricao": "Despesas Operacionais",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -687.6600000000001,
                        "2025-02-01 00:00:00": -812.6800000000001,
                        "2025-03-01 00:00:00": -718.9,
                        "2025-04-01 00:00:00": -448.02,
                        "2025-05-01 00:00:00": -781.4300000000001,
                        "2025-06-01 00:00:00": -474.06000000000006
                    },
                    "nivel": 1
                },
                {
                    "codigo": "006.02",
                    "descricao": "Despesas Administrativas",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -687.6600000000001,
                        "2025-02-01 00:00:00": -812.6800000000001,
                        "2025-03-01 00:00:00": -718.9,
                        "2025-04-01 00:00:00": -448.02,
                        "2025-05-01 00:00:00": -781.4300000000001,
                        "2025-06-01 00:00:00": -474.06000000000006
                    },
                    "nivel": 2
                },
                {
                    "codigo": "006.02.01",
                    "descricao": "Salários Administrativos",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -151.82,
                        "2025-02-01 00:00:00": -179.42,
                        "2025-03-01 00:00:00": -158.72,
                        "2025-04-01 00:00:00": -98.91,
                        "2025-05-01 00:00:00": -172.52,
                        "2025-06-01 00:00:00": -104.66
                    },
                    "nivel": 3
                },
                {
                    "codigo": "006.02.01.0001",
                    "descricao": "Equipe administrativa",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -151.82,
                        "2025-02-01 00:00:00": -179.42,
                        "2025-03-01 00:00:00": -158.72,
                        "2025-04-01 00:00:00": -98.91,
                        "2025-05-01 00:00:00": -172.52,
                        "2025-06-01 00:00:00": -104.66
                    },
                    "nivel": 4
                },
                {
                    "codigo": "006.02.02",
                    "descricao": "Serviços de Terceiros",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -138.43,
                        "2025-02-01 00:00:00": -163.60000000000002,
                        "2025-03-01 00:00:00": -144.71,
                        "2025-04-01 00:00:00": -90.19,
                        "2025-05-01 00:00:00": -157.3,
                        "2025-06-01 00:00:00": -95.43
                    },
                    "nivel": 3
                },
                {
                    "codigo": "006.02.02.0001",
                    "descricao": "Contabilidade",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -116.1,
                        "2025-02-01 00:00:00": -137.21,
                        "2025-03-01 00:00:00": -121.37,
                        "2025-04-01 00:00:00": -75.64,
                        "2025-05-01 00:00:00": -131.93,
                        "2025-06-01 00:00:00": -80.04
                    },
                    "nivel": 4
                },
                {
                    "codigo": "006.02.02.0002",
                    "descricao": "Jurídico",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -22.33,
                        "2025-02-01 00:00:00": -26.39,
                        "2025-03-01 00:00:00": -23.34,
                        "2025-04-01 00:00:00": -14.55,
                        "2025-05-01 00:00:00": -25.37,
                        "2025-06-01 00:00:00": -15.39
                    },
                    "nivel": 4
                },
                {
                    "codigo": "006.02.03",
                    "descricao": "Despesas Gerais",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -397.41,
                        "2025-02-01 00:00:00": -469.66,
                        "2025-03-01 00:00:00": -415.46999999999997,
                        "2025-04-01 00:00:00": -258.92,
                        "2025-05-01 00:00:00": -451.61,
                        "2025-06-01 00:00:00": -273.97
                    },
                    "nivel": 3
                },
                {
                    "codigo": "006.02.03.0001",
                    "descricao": "Aluguel e Condomínio",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -71.44,
                        "2025-02-01 00:00:00": -84.43,
                        "2025-03-01 00:00:00": -74.69,
                        "2025-04-01 00:00:00": -46.55,
                        "2025-05-01 00:00:00": -81.19,
                        "2025-06-01 00:00:00": -49.25
                    },
                    "nivel": 4
                },
                {
                    "codigo": "006.02.03.0002",
                    "descricao": "Internet e Telefonia",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -325.97,
                        "2025-02-01 00:00:00": -385.23,
                        "2025-03-01 00:00:00": -340.78,
                        "2025-04-01 00:00:00": -212.37,
                        "2025-05-01 00:00:00": -370.42,
                        "2025-06-01 00:00:00": -224.72
                    },
                    "nivel": 4
                },
                {
                    "codigo": "007",
                    "descricao": "Resultado Operacional",
                    "tipo": "calculo (005 + 006)",
                    "formula": "005 + 006",
                    "valores": {
                        "2025-01-01 00:00:00": 3775.1099999999997,
                        "2025-02-01 00:00:00": 4461.510000000002,
                        "2025-03-01 00:00:00": 3946.6899999999982,
                        "2025-04-01 00:00:00": 2459.5399999999995,
                        "2025-05-01 00:00:00": 4289.9000000000015,
                        "2025-06-01 00:00:00": 2602.5299999999993
                    },
                    "nivel": 1
                },
                {
                    "codigo": "009",
                    "descricao": "Resultado Antes do IR e CSLL",
                    "tipo": "calculo (007 + 008)",
                    "formula": "007 + 008",
                    "valores": {
                        "2025-01-01 00:00:00": 3775.1099999999997,
                        "2025-02-01 00:00:00": 4461.510000000002,
                        "2025-03-01 00:00:00": 3946.6899999999982,
                        "2025-04-01 00:00:00": 2459.5399999999995,
                        "2025-05-01 00:00:00": 4289.9000000000015,
                        "2025-06-01 00:00:00": 2602.5299999999993
                    },
                    "nivel": 1
                },
                {
                    "codigo": "011",
                    "descricao": "Resultado Líquido do Exercício",
                    "tipo": "calculo (009 + 010)",
                    "formula": "009 + 010",
                    "valores": {
                        "2025-01-01 00:00:00": 3775.1099999999997,
                        "2025-02-01 00:00:00": 4461.510000000002,
                        "2025-03-01 00:00:00": 3946.6899999999982,
                        "2025-04-01 00:00:00": 2459.5399999999995,
                        "2025-05-01 00:00:00": 4289.9000000000015,
                        "2025-06-01 00:00:00": 2602.5299999999993
                    },
                    "nivel": 1
                }
            ]
        },
        {
            "plan_name": "SERVISE",
            "data_source_name": "GRUPO GOLEIRO CROS",
            "periodos": [
                "2025-01-01 00:00:00",
                "2025-02-01 00:00:00",
                "2025-03-01 00:00:00",
                "2025-04-01 00:00:00",
                "2025-05-01 00:00:00",
                "2025-06-01 00:00:00",
                "2025-07-01 00:00:00",
                "2025-08-01 00:00:00",
                "2025-09-01 00:00:00"
            ],
            "accounts": [
                {
                    "codigo": "001",
                    "descricao": "Receita Bruta",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 11898.82,
                        "2025-02-01 00:00:00": 14062.240000000002,
                        "2025-03-01 00:00:00": 12439.649999999998,
                        "2025-04-01 00:00:00": 7752.259999999999,
                        "2025-05-01 00:00:00": 13521.380000000001,
                        "2025-06-01 00:00:00": 8202.97,
                        "2025-07-01 00:00:00": 12439.649999999998,
                        "2025-08-01 00:00:00": 11898.82,
                        "2025-09-01 00:00:00": 7752.259999999999
                    },
                    "nivel": 1
                },
                {
                    "codigo": "001.01",
                    "descricao": "Receita sobre Serviços",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 11898.82,
                        "2025-02-01 00:00:00": 14062.240000000002,
                        "2025-03-01 00:00:00": 12439.649999999998,
                        "2025-04-01 00:00:00": 7752.259999999999,
                        "2025-05-01 00:00:00": 13521.380000000001,
                        "2025-06-01 00:00:00": 8202.97,
                        "2025-07-01 00:00:00": 12439.649999999998,
                        "2025-08-01 00:00:00": 11898.82,
                        "2025-09-01 00:00:00": 7752.259999999999
                    },
                    "nivel": 2
                },
                {
                    "codigo": "001.01.01",
                    "descricao": "Receita de Projetos de Software",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 2505.0200000000004,
                        "2025-02-01 00:00:00": 2960.4700000000003,
                        "2025-03-01 00:00:00": 2618.87,
                        "2025-04-01 00:00:00": 1632.06,
                        "2025-05-01 00:00:00": 2846.6000000000004,
                        "2025-06-01 00:00:00": 1726.94,
                        "2025-07-01 00:00:00": 2618.87,
                        "2025-08-01 00:00:00": 2505.0200000000004,
                        "2025-09-01 00:00:00": 1632.06
                    },
                    "nivel": 3
                },
                {
                    "codigo": "001.01.01.0001",
                    "descricao": "Desenvolvimento sob demanda",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 1415.88,
                        "2025-02-01 00:00:00": 1673.31,
                        "2025-03-01 00:00:00": 1480.23,
                        "2025-04-01 00:00:00": 922.47,
                        "2025-05-01 00:00:00": 1608.95,
                        "2025-06-01 00:00:00": 976.1,
                        "2025-07-01 00:00:00": 1480.23,
                        "2025-08-01 00:00:00": 1415.88,
                        "2025-09-01 00:00:00": 922.47
                    },
                    "nivel": 4
                },
                {
                    "codigo": "001.01.01.0002",
                    "descricao": "Integração de sistemas",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 1089.14,
                        "2025-02-01 00:00:00": 1287.16,
                        "2025-03-01 00:00:00": 1138.64,
                        "2025-04-01 00:00:00": 709.59,
                        "2025-05-01 00:00:00": 1237.65,
                        "2025-06-01 00:00:00": 750.84,
                        "2025-07-01 00:00:00": 1138.64,
                        "2025-08-01 00:00:00": 1089.14,
                        "2025-09-01 00:00:00": 709.59
                    },
                    "nivel": 4
                },
                {
                    "codigo": "001.01.02",
                    "descricao": "Receita de Manutenção e Suporte",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 3594.15,
                        "2025-02-01 00:00:00": 4247.63,
                        "2025-03-01 00:00:00": 3757.52,
                        "2025-04-01 00:00:00": 2341.64,
                        "2025-05-01 00:00:00": 4084.27,
                        "2025-06-01 00:00:00": 2477.79,
                        "2025-07-01 00:00:00": 3757.52,
                        "2025-08-01 00:00:00": 3594.15,
                        "2025-09-01 00:00:00": 2341.64
                    },
                    "nivel": 3
                },
                {
                    "codigo": "001.01.02.0001",
                    "descricao": "Suporte técnico mensal",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 898.54,
                        "2025-02-01 00:00:00": 1061.91,
                        "2025-03-01 00:00:00": 939.38,
                        "2025-04-01 00:00:00": 585.41,
                        "2025-05-01 00:00:00": 1021.07,
                        "2025-06-01 00:00:00": 619.45,
                        "2025-07-01 00:00:00": 939.38,
                        "2025-08-01 00:00:00": 898.54,
                        "2025-09-01 00:00:00": 585.41
                    },
                    "nivel": 4
                },
                {
                    "codigo": "001.01.02.0002",
                    "descricao": "Atualizações e correções",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 2695.61,
                        "2025-02-01 00:00:00": 3185.72,
                        "2025-03-01 00:00:00": 2818.14,
                        "2025-04-01 00:00:00": 1756.23,
                        "2025-05-01 00:00:00": 3063.2,
                        "2025-06-01 00:00:00": 1858.34,
                        "2025-07-01 00:00:00": 2818.14,
                        "2025-08-01 00:00:00": 2695.61,
                        "2025-09-01 00:00:00": 1756.23
                    },
                    "nivel": 4
                },
                {
                    "codigo": "001.01.03",
                    "descricao": "Receita de Consultoria",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 2232.73,
                        "2025-02-01 00:00:00": 2638.6800000000003,
                        "2025-03-01 00:00:00": 2334.21,
                        "2025-04-01 00:00:00": 1454.66,
                        "2025-05-01 00:00:00": 2537.19,
                        "2025-06-01 00:00:00": 1539.23,
                        "2025-07-01 00:00:00": 2334.21,
                        "2025-08-01 00:00:00": 2232.73,
                        "2025-09-01 00:00:00": 1454.66
                    },
                    "nivel": 3
                },
                {
                    "codigo": "001.01.03.0001",
                    "descricao": "Consultoria técnica",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 54.46,
                        "2025-02-01 00:00:00": 64.36,
                        "2025-03-01 00:00:00": 56.93,
                        "2025-04-01 00:00:00": 35.48,
                        "2025-05-01 00:00:00": 61.88,
                        "2025-06-01 00:00:00": 37.54,
                        "2025-07-01 00:00:00": 56.93,
                        "2025-08-01 00:00:00": 54.46,
                        "2025-09-01 00:00:00": 35.48
                    },
                    "nivel": 4
                },
                {
                    "codigo": "001.01.03.0002",
                    "descricao": "Treinamentos e workshops",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 2178.27,
                        "2025-02-01 00:00:00": 2574.32,
                        "2025-03-01 00:00:00": 2277.28,
                        "2025-04-01 00:00:00": 1419.18,
                        "2025-05-01 00:00:00": 2475.31,
                        "2025-06-01 00:00:00": 1501.69,
                        "2025-07-01 00:00:00": 2277.28,
                        "2025-08-01 00:00:00": 2178.27,
                        "2025-09-01 00:00:00": 1419.18
                    },
                    "nivel": 4
                },
                {
                    "codigo": "001.01.04",
                    "descricao": "Receita de Licenciamento",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 3566.92,
                        "2025-02-01 00:00:00": 4215.46,
                        "2025-03-01 00:00:00": 3729.05,
                        "2025-04-01 00:00:00": 2323.8999999999996,
                        "2025-05-01 00:00:00": 4053.32,
                        "2025-06-01 00:00:00": 2459.01,
                        "2025-07-01 00:00:00": 3729.05,
                        "2025-08-01 00:00:00": 3566.92,
                        "2025-09-01 00:00:00": 2323.8999999999996
                    },
                    "nivel": 3
                },
                {
                    "codigo": "001.01.04.0001",
                    "descricao": "Licença mensal SaaS",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 1769.85,
                        "2025-02-01 00:00:00": 2091.64,
                        "2025-03-01 00:00:00": 1850.29,
                        "2025-04-01 00:00:00": 1153.08,
                        "2025-05-01 00:00:00": 2011.19,
                        "2025-06-01 00:00:00": 1220.12,
                        "2025-07-01 00:00:00": 1850.29,
                        "2025-08-01 00:00:00": 1769.85,
                        "2025-09-01 00:00:00": 1153.08
                    },
                    "nivel": 4
                },
                {
                    "codigo": "001.01.04.0002",
                    "descricao": "Licença perpétua",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 1797.07,
                        "2025-02-01 00:00:00": 2123.82,
                        "2025-03-01 00:00:00": 1878.76,
                        "2025-04-01 00:00:00": 1170.82,
                        "2025-05-01 00:00:00": 2042.13,
                        "2025-06-01 00:00:00": 1238.89,
                        "2025-07-01 00:00:00": 1878.76,
                        "2025-08-01 00:00:00": 1797.07,
                        "2025-09-01 00:00:00": 1170.82
                    },
                    "nivel": 4
                },
                {
                    "codigo": "002",
                    "descricao": "Deduções da Receita Bruta",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -4198.87,
                        "2025-02-01 00:00:00": -4962.299999999999,
                        "2025-03-01 00:00:00": -4389.73,
                        "2025-04-01 00:00:00": -2735.63,
                        "2025-05-01 00:00:00": -4771.44,
                        "2025-06-01 00:00:00": -2894.6800000000003,
                        "2025-07-01 00:00:00": -4389.73,
                        "2025-08-01 00:00:00": -4198.87,
                        "2025-09-01 00:00:00": -2735.63
                    },
                    "nivel": 1
                },
                {
                    "codigo": "002.01",
                    "descricao": "Impostos sobre Receita",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -1294.81,
                        "2025-02-01 00:00:00": -1530.23,
                        "2025-03-01 00:00:00": -1353.6599999999999,
                        "2025-04-01 00:00:00": -843.5899999999999,
                        "2025-05-01 00:00:00": -1471.37,
                        "2025-06-01 00:00:00": -892.6300000000001,
                        "2025-07-01 00:00:00": -1353.6599999999999,
                        "2025-08-01 00:00:00": -1294.81,
                        "2025-09-01 00:00:00": -843.5899999999999
                    },
                    "nivel": 2
                },
                {
                    "codigo": "002.01.01",
                    "descricao": "ISS",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -18.5,
                        "2025-02-01 00:00:00": -21.86,
                        "2025-03-01 00:00:00": -19.34,
                        "2025-04-01 00:00:00": -12.05,
                        "2025-05-01 00:00:00": -21.02,
                        "2025-06-01 00:00:00": -12.75,
                        "2025-07-01 00:00:00": -19.34,
                        "2025-08-01 00:00:00": -18.5,
                        "2025-09-01 00:00:00": -12.05
                    },
                    "nivel": 3
                },
                {
                    "codigo": "002.01.01.0001",
                    "descricao": "ISS sobre serviços locais",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -18.5,
                        "2025-02-01 00:00:00": -21.86,
                        "2025-03-01 00:00:00": -19.34,
                        "2025-04-01 00:00:00": -12.05,
                        "2025-05-01 00:00:00": -21.02,
                        "2025-06-01 00:00:00": -12.75,
                        "2025-07-01 00:00:00": -19.34,
                        "2025-08-01 00:00:00": -18.5,
                        "2025-09-01 00:00:00": -12.05
                    },
                    "nivel": 4
                },
                {
                    "codigo": "002.01.02",
                    "descricao": "PIS/COFINS",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -1276.31,
                        "2025-02-01 00:00:00": -1508.3700000000001,
                        "2025-03-01 00:00:00": -1334.32,
                        "2025-04-01 00:00:00": -831.54,
                        "2025-05-01 00:00:00": -1450.35,
                        "2025-06-01 00:00:00": -879.8800000000001,
                        "2025-07-01 00:00:00": -1334.32,
                        "2025-08-01 00:00:00": -1276.31,
                        "2025-09-01 00:00:00": -831.54
                    },
                    "nivel": 3
                },
                {
                    "codigo": "002.01.02.0001",
                    "descricao": "PIS",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -850.87,
                        "2025-02-01 00:00:00": -1005.58,
                        "2025-03-01 00:00:00": -889.55,
                        "2025-04-01 00:00:00": -554.36,
                        "2025-05-01 00:00:00": -966.9,
                        "2025-06-01 00:00:00": -586.59,
                        "2025-07-01 00:00:00": -889.55,
                        "2025-08-01 00:00:00": -850.87,
                        "2025-09-01 00:00:00": -554.36
                    },
                    "nivel": 4
                },
                {
                    "codigo": "002.01.02.0002",
                    "descricao": "COFINS",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -425.44,
                        "2025-02-01 00:00:00": -502.79,
                        "2025-03-01 00:00:00": -444.77,
                        "2025-04-01 00:00:00": -277.18,
                        "2025-05-01 00:00:00": -483.45,
                        "2025-06-01 00:00:00": -293.29,
                        "2025-07-01 00:00:00": -444.77,
                        "2025-08-01 00:00:00": -425.44,
                        "2025-09-01 00:00:00": -277.18
                    },
                    "nivel": 4
                },
                {
                    "codigo": "002.02",
                    "descricao": "Devoluções e Descontos",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -2904.06,
                        "2025-02-01 00:00:00": -3432.0699999999997,
                        "2025-03-01 00:00:00": -3036.07,
                        "2025-04-01 00:00:00": -1892.04,
                        "2025-05-01 00:00:00": -3300.0699999999997,
                        "2025-06-01 00:00:00": -2002.0500000000002,
                        "2025-07-01 00:00:00": -3036.07,
                        "2025-08-01 00:00:00": -2904.06,
                        "2025-09-01 00:00:00": -1892.04
                    },
                    "nivel": 2
                },
                {
                    "codigo": "002.02.01",
                    "descricao": "Descontos concedidos",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -1183.82,
                        "2025-02-01 00:00:00": -1399.06,
                        "2025-03-01 00:00:00": -1237.63,
                        "2025-04-01 00:00:00": -771.28,
                        "2025-05-01 00:00:00": -1345.25,
                        "2025-06-01 00:00:00": -816.12,
                        "2025-07-01 00:00:00": -1237.63,
                        "2025-08-01 00:00:00": -1183.82,
                        "2025-09-01 00:00:00": -771.28
                    },
                    "nivel": 3
                },
                {
                    "codigo": "002.02.01.0001",
                    "descricao": "Descontos comerciais",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -1183.82,
                        "2025-02-01 00:00:00": -1399.06,
                        "2025-03-01 00:00:00": -1237.63,
                        "2025-04-01 00:00:00": -771.28,
                        "2025-05-01 00:00:00": -1345.25,
                        "2025-06-01 00:00:00": -816.12,
                        "2025-07-01 00:00:00": -1237.63,
                        "2025-08-01 00:00:00": -1183.82,
                        "2025-09-01 00:00:00": -771.28
                    },
                    "nivel": 4
                },
                {
                    "codigo": "002.02.02",
                    "descricao": "Estornos e cancelamentos",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -1720.24,
                        "2025-02-01 00:00:00": -2033.01,
                        "2025-03-01 00:00:00": -1798.44,
                        "2025-04-01 00:00:00": -1120.76,
                        "2025-05-01 00:00:00": -1954.82,
                        "2025-06-01 00:00:00": -1185.93,
                        "2025-07-01 00:00:00": -1798.44,
                        "2025-08-01 00:00:00": -1720.24,
                        "2025-09-01 00:00:00": -1120.76
                    },
                    "nivel": 3
                },
                {
                    "codigo": "002.02.02.0001",
                    "descricao": "Estorno de serviços",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -1720.24,
                        "2025-02-01 00:00:00": -2033.01,
                        "2025-03-01 00:00:00": -1798.44,
                        "2025-04-01 00:00:00": -1120.76,
                        "2025-05-01 00:00:00": -1954.82,
                        "2025-06-01 00:00:00": -1185.93,
                        "2025-07-01 00:00:00": -1798.44,
                        "2025-08-01 00:00:00": -1720.24,
                        "2025-09-01 00:00:00": -1120.76
                    },
                    "nivel": 4
                },
                {
                    "codigo": "003",
                    "descricao": "Receita Líquida",
                    "tipo": "calculo (001 + 002)",
                    "formula": "001 + 002",
                    "valores": {
                        "2025-01-01 00:00:00": 7699.95,
                        "2025-02-01 00:00:00": 9099.940000000002,
                        "2025-03-01 00:00:00": 8049.919999999998,
                        "2025-04-01 00:00:00": 5016.629999999999,
                        "2025-05-01 00:00:00": 8749.940000000002,
                        "2025-06-01 00:00:00": 5308.289999999999,
                        "2025-07-01 00:00:00": 8049.919999999998,
                        "2025-08-01 00:00:00": 7699.95,
                        "2025-09-01 00:00:00": 5016.629999999999
                    },
                    "nivel": 1
                },
                {
                    "codigo": "004",
                    "descricao": "Custos dos Serviços Prestados",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -3237.1800000000003,
                        "2025-02-01 00:00:00": -3825.75,
                        "2025-03-01 00:00:00": -3384.33,
                        "2025-04-01 00:00:00": -2109.0699999999997,
                        "2025-05-01 00:00:00": -3678.61,
                        "2025-06-01 00:00:00": -2231.7,
                        "2025-07-01 00:00:00": -3384.33,
                        "2025-08-01 00:00:00": -3237.1800000000003,
                        "2025-09-01 00:00:00": -2109.0699999999997
                    },
                    "nivel": 1
                },
                {
                    "codigo": "004.01",
                    "descricao": "Mão de Obra Direta",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -3237.1800000000003,
                        "2025-02-01 00:00:00": -3825.75,
                        "2025-03-01 00:00:00": -3384.33,
                        "2025-04-01 00:00:00": -2109.0699999999997,
                        "2025-05-01 00:00:00": -3678.61,
                        "2025-06-01 00:00:00": -2231.7,
                        "2025-07-01 00:00:00": -3384.33,
                        "2025-08-01 00:00:00": -3237.1800000000003,
                        "2025-09-01 00:00:00": -2109.0699999999997
                    },
                    "nivel": 2
                },
                {
                    "codigo": "004.01.01",
                    "descricao": "Salários técnicos",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -1623.8600000000001,
                        "2025-02-01 00:00:00": -1919.1100000000001,
                        "2025-03-01 00:00:00": -1697.68,
                        "2025-04-01 00:00:00": -1057.97,
                        "2025-05-01 00:00:00": -1845.3000000000002,
                        "2025-06-01 00:00:00": -1119.48,
                        "2025-07-01 00:00:00": -1697.68,
                        "2025-08-01 00:00:00": -1623.8600000000001,
                        "2025-09-01 00:00:00": -1057.97
                    },
                    "nivel": 3
                },
                {
                    "codigo": "004.01.01.0001",
                    "descricao": "Desenvolvedores",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -970.1,
                        "2025-02-01 00:00:00": -1146.48,
                        "2025-03-01 00:00:00": -1014.2,
                        "2025-04-01 00:00:00": -632.03,
                        "2025-05-01 00:00:00": -1102.39,
                        "2025-06-01 00:00:00": -668.78,
                        "2025-07-01 00:00:00": -1014.2,
                        "2025-08-01 00:00:00": -970.1,
                        "2025-09-01 00:00:00": -632.03
                    },
                    "nivel": 4
                },
                {
                    "codigo": "004.01.01.0002",
                    "descricao": "Testadores (QA)",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -653.76,
                        "2025-02-01 00:00:00": -772.63,
                        "2025-03-01 00:00:00": -683.48,
                        "2025-04-01 00:00:00": -425.94,
                        "2025-05-01 00:00:00": -742.91,
                        "2025-06-01 00:00:00": -450.7,
                        "2025-07-01 00:00:00": -683.48,
                        "2025-08-01 00:00:00": -653.76,
                        "2025-09-01 00:00:00": -425.94
                    },
                    "nivel": 4
                },
                {
                    "codigo": "004.01.02",
                    "descricao": "Encargos e benefícios",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -1613.3200000000002,
                        "2025-02-01 00:00:00": -1906.6399999999999,
                        "2025-03-01 00:00:00": -1686.6499999999999,
                        "2025-04-01 00:00:00": -1051.1,
                        "2025-05-01 00:00:00": -1833.31,
                        "2025-06-01 00:00:00": -1112.22,
                        "2025-07-01 00:00:00": -1686.6499999999999,
                        "2025-08-01 00:00:00": -1613.3200000000002,
                        "2025-09-01 00:00:00": -1051.1
                    },
                    "nivel": 3
                },
                {
                    "codigo": "004.01.02.0001",
                    "descricao": "Encargos sociais",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -1043.91,
                        "2025-02-01 00:00:00": -1233.71,
                        "2025-03-01 00:00:00": -1091.36,
                        "2025-04-01 00:00:00": -680.12,
                        "2025-05-01 00:00:00": -1186.26,
                        "2025-06-01 00:00:00": -719.67,
                        "2025-07-01 00:00:00": -1091.36,
                        "2025-08-01 00:00:00": -1043.91,
                        "2025-09-01 00:00:00": -680.12
                    },
                    "nivel": 4
                },
                {
                    "codigo": "004.01.02.0002",
                    "descricao": "Benefícios (VR, VT, etc.)",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -569.41,
                        "2025-02-01 00:00:00": -672.93,
                        "2025-03-01 00:00:00": -595.29,
                        "2025-04-01 00:00:00": -370.98,
                        "2025-05-01 00:00:00": -647.05,
                        "2025-06-01 00:00:00": -392.55,
                        "2025-07-01 00:00:00": -595.29,
                        "2025-08-01 00:00:00": -569.41,
                        "2025-09-01 00:00:00": -370.98
                    },
                    "nivel": 4
                },
                {
                    "codigo": "005",
                    "descricao": "Lucro Bruto",
                    "tipo": "calculo (003 + 004)",
                    "formula": "003 + 004",
                    "valores": {
                        "2025-01-01 00:00:00": 4462.7699999999995,
                        "2025-02-01 00:00:00": 5274.190000000002,
                        "2025-03-01 00:00:00": 4665.589999999998,
                        "2025-04-01 00:00:00": 2907.5599999999995,
                        "2025-05-01 00:00:00": 5071.330000000002,
                        "2025-06-01 00:00:00": 3076.5899999999992,
                        "2025-07-01 00:00:00": 4665.589999999998,
                        "2025-08-01 00:00:00": 4462.7699999999995,
                        "2025-09-01 00:00:00": 2907.5599999999995
                    },
                    "nivel": 1
                },
                {
                    "codigo": "006",
                    "descricao": "Despesas Operacionais",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -687.6600000000001,
                        "2025-02-01 00:00:00": -812.6800000000001,
                        "2025-03-01 00:00:00": -718.9,
                        "2025-04-01 00:00:00": -448.02,
                        "2025-05-01 00:00:00": -781.4300000000001,
                        "2025-06-01 00:00:00": -474.06000000000006,
                        "2025-07-01 00:00:00": -718.9,
                        "2025-08-01 00:00:00": -687.6600000000001,
                        "2025-09-01 00:00:00": -448.02
                    },
                    "nivel": 1
                },
                {
                    "codigo": "006.02",
                    "descricao": "Despesas Administrativas",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -687.6600000000001,
                        "2025-02-01 00:00:00": -812.6800000000001,
                        "2025-03-01 00:00:00": -718.9,
                        "2025-04-01 00:00:00": -448.02,
                        "2025-05-01 00:00:00": -781.4300000000001,
                        "2025-06-01 00:00:00": -474.06000000000006,
                        "2025-07-01 00:00:00": -718.9,
                        "2025-08-01 00:00:00": -687.6600000000001,
                        "2025-09-01 00:00:00": -448.02
                    },
                    "nivel": 2
                },
                {
                    "codigo": "006.02.01",
                    "descricao": "Salários Administrativos",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -151.82,
                        "2025-02-01 00:00:00": -179.42,
                        "2025-03-01 00:00:00": -158.72,
                        "2025-04-01 00:00:00": -98.91,
                        "2025-05-01 00:00:00": -172.52,
                        "2025-06-01 00:00:00": -104.66,
                        "2025-07-01 00:00:00": -158.72,
                        "2025-08-01 00:00:00": -151.82,
                        "2025-09-01 00:00:00": -98.91
                    },
                    "nivel": 3
                },
                {
                    "codigo": "006.02.01.0001",
                    "descricao": "Equipe administrativa",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -151.82,
                        "2025-02-01 00:00:00": -179.42,
                        "2025-03-01 00:00:00": -158.72,
                        "2025-04-01 00:00:00": -98.91,
                        "2025-05-01 00:00:00": -172.52,
                        "2025-06-01 00:00:00": -104.66,
                        "2025-07-01 00:00:00": -158.72,
                        "2025-08-01 00:00:00": -151.82,
                        "2025-09-01 00:00:00": -98.91
                    },
                    "nivel": 4
                },
                {
                    "codigo": "006.02.02",
                    "descricao": "Serviços de Terceiros",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -138.43,
                        "2025-02-01 00:00:00": -163.60000000000002,
                        "2025-03-01 00:00:00": -144.71,
                        "2025-04-01 00:00:00": -90.19,
                        "2025-05-01 00:00:00": -157.3,
                        "2025-06-01 00:00:00": -95.43,
                        "2025-07-01 00:00:00": -144.71,
                        "2025-08-01 00:00:00": -138.43,
                        "2025-09-01 00:00:00": -90.19
                    },
                    "nivel": 3
                },
                {
                    "codigo": "006.02.02.0001",
                    "descricao": "Contabilidade",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -116.1,
                        "2025-02-01 00:00:00": -137.21,
                        "2025-03-01 00:00:00": -121.37,
                        "2025-04-01 00:00:00": -75.64,
                        "2025-05-01 00:00:00": -131.93,
                        "2025-06-01 00:00:00": -80.04,
                        "2025-07-01 00:00:00": -121.37,
                        "2025-08-01 00:00:00": -116.1,
                        "2025-09-01 00:00:00": -75.64
                    },
                    "nivel": 4
                },
                {
                    "codigo": "006.02.02.0002",
                    "descricao": "Jurídico",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -22.33,
                        "2025-02-01 00:00:00": -26.39,
                        "2025-03-01 00:00:00": -23.34,
                        "2025-04-01 00:00:00": -14.55,
                        "2025-05-01 00:00:00": -25.37,
                        "2025-06-01 00:00:00": -15.39,
                        "2025-07-01 00:00:00": -23.34,
                        "2025-08-01 00:00:00": -22.33,
                        "2025-09-01 00:00:00": -14.55
                    },
                    "nivel": 4
                },
                {
                    "codigo": "006.02.03",
                    "descricao": "Despesas Gerais",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -397.41,
                        "2025-02-01 00:00:00": -469.66,
                        "2025-03-01 00:00:00": -415.46999999999997,
                        "2025-04-01 00:00:00": -258.92,
                        "2025-05-01 00:00:00": -451.61,
                        "2025-06-01 00:00:00": -273.97,
                        "2025-07-01 00:00:00": -415.46999999999997,
                        "2025-08-01 00:00:00": -397.41,
                        "2025-09-01 00:00:00": -258.92
                    },
                    "nivel": 3
                },
                {
                    "codigo": "006.02.03.0001",
                    "descricao": "Aluguel e Condomínio",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -71.44,
                        "2025-02-01 00:00:00": -84.43,
                        "2025-03-01 00:00:00": -74.69,
                        "2025-04-01 00:00:00": -46.55,
                        "2025-05-01 00:00:00": -81.19,
                        "2025-06-01 00:00:00": -49.25,
                        "2025-07-01 00:00:00": -74.69,
                        "2025-08-01 00:00:00": -71.44,
                        "2025-09-01 00:00:00": -46.55
                    },
                    "nivel": 4
                },
                {
                    "codigo": "006.02.03.0002",
                    "descricao": "Internet e Telefonia",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -325.97,
                        "2025-02-01 00:00:00": -385.23,
                        "2025-03-01 00:00:00": -340.78,
                        "2025-04-01 00:00:00": -212.37,
                        "2025-05-01 00:00:00": -370.42,
                        "2025-06-01 00:00:00": -224.72,
                        "2025-07-01 00:00:00": -340.78,
                        "2025-08-01 00:00:00": -325.97,
                        "2025-09-01 00:00:00": -212.37
                    },
                    "nivel": 4
                },
                {
                    "codigo": "007",
                    "descricao": "Resultado Operacional",
                    "tipo": "calculo (005 + 006)",
                    "formula": "005 + 006",
                    "valores": {
                        "2025-01-01 00:00:00": 3775.1099999999997,
                        "2025-02-01 00:00:00": 4461.510000000002,
                        "2025-03-01 00:00:00": 3946.6899999999982,
                        "2025-04-01 00:00:00": 2459.5399999999995,
                        "2025-05-01 00:00:00": 4289.9000000000015,
                        "2025-06-01 00:00:00": 2602.5299999999993,
                        "2025-07-01 00:00:00": 3946.6899999999982,
                        "2025-08-01 00:00:00": 3775.1099999999997,
                        "2025-09-01 00:00:00": 2459.5399999999995
                    },
                    "nivel": 1
                },
                {
                    "codigo": "009",
                    "descricao": "Resultado Antes do IR e CSLL",
                    "tipo": "calculo (007 + 008)",
                    "formula": "007 + 008",
                    "valores": {
                        "2025-01-01 00:00:00": 3775.1099999999997,
                        "2025-02-01 00:00:00": 4461.510000000002,
                        "2025-03-01 00:00:00": 3946.6899999999982,
                        "2025-04-01 00:00:00": 2459.5399999999995,
                        "2025-05-01 00:00:00": 4289.9000000000015,
                        "2025-06-01 00:00:00": 2602.5299999999993,
                        "2025-07-01 00:00:00": 3946.6899999999982,
                        "2025-08-01 00:00:00": 3775.1099999999997,
                        "2025-09-01 00:00:00": 2459.5399999999995
                    },
                    "nivel": 1
                },
                {
                    "codigo": "011",
                    "descricao": "Resultado Líquido do Exercício",
                    "tipo": "calculo (009 + 010)",
                    "formula": "009 + 010",
                    "valores": {
                        "2025-01-01 00:00:00": 3775.1099999999997,
                        "2025-02-01 00:00:00": 4461.510000000002,
                        "2025-03-01 00:00:00": 3946.6899999999982,
                        "2025-04-01 00:00:00": 2459.5399999999995,
                        "2025-05-01 00:00:00": 4289.9000000000015,
                        "2025-06-01 00:00:00": 2602.5299999999993,
                        "2025-07-01 00:00:00": 3946.6899999999982,
                        "2025-08-01 00:00:00": 3775.1099999999997,
                        "2025-09-01 00:00:00": 2459.5399999999995
                    },
                    "nivel": 1
                }
            ]
        },
        {
            "plan_name": "COMERCIO",
            "data_source_name": "BOLEIRO",
            "periodos": [
                "2025-01-01 00:00:00",
                "2025-02-01 00:00:00",
                "2025-03-01 00:00:00",
                "2025-04-01 00:00:00",
                "2025-05-01 00:00:00",
                "2025-06-01 00:00:00"
            ],
            "accounts": [
                {
                    "codigo": "001",
                    "descricao": "Receita Bruta",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 13961.57,
                        "2025-02-01 00:00:00": 9421.240000000002,
                        "2025-03-01 00:00:00": 13961.57,
                        "2025-04-01 00:00:00": 9534.74,
                        "2025-05-01 00:00:00": 17820.89,
                        "2025-06-01 00:00:00": 15777.720000000001
                    },
                    "nivel": 1
                },
                {
                    "codigo": "001.01",
                    "descricao": "Receita com Produtos",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 12282.41,
                        "2025-02-01 00:00:00": 8288.150000000001,
                        "2025-03-01 00:00:00": 12282.41,
                        "2025-04-01 00:00:00": 8387.99,
                        "2025-05-01 00:00:00": 15677.569999999998,
                        "2025-06-01 00:00:00": 13880.130000000001
                    },
                    "nivel": 2
                },
                {
                    "codigo": "001.01.01",
                    "descricao": "Venda de Pães",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 3528.13,
                        "2025-02-01 00:00:00": 2380.7700000000004,
                        "2025-03-01 00:00:00": 3528.13,
                        "2025-04-01 00:00:00": 2409.46,
                        "2025-05-01 00:00:00": 4503.389999999999,
                        "2025-06-01 00:00:00": 3987.0699999999997
                    },
                    "nivel": 3
                },
                {
                    "codigo": "001.01.01.0001",
                    "descricao": "Pães tradicionais",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 56.6,
                        "2025-02-01 00:00:00": 38.19,
                        "2025-03-01 00:00:00": 56.6,
                        "2025-04-01 00:00:00": 38.65,
                        "2025-05-01 00:00:00": 72.25,
                        "2025-06-01 00:00:00": 63.96
                    },
                    "nivel": 4
                },
                {
                    "codigo": "001.01.01.0002",
                    "descricao": "Pães especiais e integrais",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 1641.43,
                        "2025-02-01 00:00:00": 1107.63,
                        "2025-03-01 00:00:00": 1641.43,
                        "2025-04-01 00:00:00": 1120.98,
                        "2025-05-01 00:00:00": 2095.16,
                        "2025-06-01 00:00:00": 1854.95
                    },
                    "nivel": 4
                },
                {
                    "codigo": "001.01.01.0003",
                    "descricao": "Pães recheados",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 1830.1,
                        "2025-02-01 00:00:00": 1234.95,
                        "2025-03-01 00:00:00": 1830.1,
                        "2025-04-01 00:00:00": 1249.83,
                        "2025-05-01 00:00:00": 2335.98,
                        "2025-06-01 00:00:00": 2068.16
                    },
                    "nivel": 4
                },
                {
                    "codigo": "001.01.02",
                    "descricao": "Venda de Bolos",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 2207.44,
                        "2025-02-01 00:00:00": 1489.58,
                        "2025-03-01 00:00:00": 2207.44,
                        "2025-04-01 00:00:00": 1507.52,
                        "2025-05-01 00:00:00": 2817.62,
                        "2025-06-01 00:00:00": 2494.59
                    },
                    "nivel": 3
                },
                {
                    "codigo": "001.01.02.0001",
                    "descricao": "Bolos simples",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 1339.56,
                        "2025-02-01 00:00:00": 903.93,
                        "2025-03-01 00:00:00": 1339.56,
                        "2025-04-01 00:00:00": 914.82,
                        "2025-05-01 00:00:00": 1709.84,
                        "2025-06-01 00:00:00": 1513.81
                    },
                    "nivel": 4
                },
                {
                    "codigo": "001.01.02.0002",
                    "descricao": "Bolos recheados",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 113.2,
                        "2025-02-01 00:00:00": 76.39,
                        "2025-03-01 00:00:00": 113.2,
                        "2025-04-01 00:00:00": 77.31,
                        "2025-05-01 00:00:00": 144.49,
                        "2025-06-01 00:00:00": 127.93
                    },
                    "nivel": 4
                },
                {
                    "codigo": "001.01.02.0003",
                    "descricao": "Bolos personalizados por encomenda",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 754.68,
                        "2025-02-01 00:00:00": 509.26,
                        "2025-03-01 00:00:00": 754.68,
                        "2025-04-01 00:00:00": 515.39,
                        "2025-05-01 00:00:00": 963.29,
                        "2025-06-01 00:00:00": 852.85
                    },
                    "nivel": 4
                },
                {
                    "codigo": "001.01.03",
                    "descricao": "Venda de Salgados",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 2773.45,
                        "2025-02-01 00:00:00": 1871.52,
                        "2025-03-01 00:00:00": 2773.45,
                        "2025-04-01 00:00:00": 1894.06,
                        "2025-05-01 00:00:00": 3540.1,
                        "2025-06-01 00:00:00": 3134.2200000000003
                    },
                    "nivel": 3
                },
                {
                    "codigo": "001.01.03.0001",
                    "descricao": "Coxinhas, empadas e esfihas",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 1698.03,
                        "2025-02-01 00:00:00": 1145.83,
                        "2025-03-01 00:00:00": 1698.03,
                        "2025-04-01 00:00:00": 1159.63,
                        "2025-05-01 00:00:00": 2167.41,
                        "2025-06-01 00:00:00": 1918.91
                    },
                    "nivel": 4
                },
                {
                    "codigo": "001.01.03.0002",
                    "descricao": "Quiches e tortas salgadas",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 1075.42,
                        "2025-02-01 00:00:00": 725.69,
                        "2025-03-01 00:00:00": 1075.42,
                        "2025-04-01 00:00:00": 734.43,
                        "2025-05-01 00:00:00": 1372.69,
                        "2025-06-01 00:00:00": 1215.31
                    },
                    "nivel": 4
                },
                {
                    "codigo": "001.01.04",
                    "descricao": "Venda de Doces",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 660.34,
                        "2025-02-01 00:00:00": 445.59999999999997,
                        "2025-03-01 00:00:00": 660.34,
                        "2025-04-01 00:00:00": 450.96,
                        "2025-05-01 00:00:00": 842.88,
                        "2025-06-01 00:00:00": 746.24
                    },
                    "nivel": 3
                },
                {
                    "codigo": "001.01.04.0001",
                    "descricao": "Brigadeiros, beijinhos, cajuzinhos",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 169.8,
                        "2025-02-01 00:00:00": 114.58,
                        "2025-03-01 00:00:00": 169.8,
                        "2025-04-01 00:00:00": 115.96,
                        "2025-05-01 00:00:00": 216.74,
                        "2025-06-01 00:00:00": 191.89
                    },
                    "nivel": 4
                },
                {
                    "codigo": "001.01.04.0002",
                    "descricao": "Tortas doces e sobremesas",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 490.54,
                        "2025-02-01 00:00:00": 331.02,
                        "2025-03-01 00:00:00": 490.54,
                        "2025-04-01 00:00:00": 335.0,
                        "2025-05-01 00:00:00": 626.14,
                        "2025-06-01 00:00:00": 554.35
                    },
                    "nivel": 4
                },
                {
                    "codigo": "001.01.05",
                    "descricao": "Venda de Bebidas",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 3113.0499999999997,
                        "2025-02-01 00:00:00": 2100.6800000000003,
                        "2025-03-01 00:00:00": 3113.0499999999997,
                        "2025-04-01 00:00:00": 2125.99,
                        "2025-05-01 00:00:00": 3973.58,
                        "2025-06-01 00:00:00": 3518.01
                    },
                    "nivel": 3
                },
                {
                    "codigo": "001.01.05.0001",
                    "descricao": "Café e chás",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 735.81,
                        "2025-02-01 00:00:00": 496.52,
                        "2025-03-01 00:00:00": 735.81,
                        "2025-04-01 00:00:00": 502.51,
                        "2025-05-01 00:00:00": 939.21,
                        "2025-06-01 00:00:00": 831.53
                    },
                    "nivel": 4
                },
                {
                    "codigo": "001.01.05.0002",
                    "descricao": "Sucos e refrigerantes",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 792.41,
                        "2025-02-01 00:00:00": 534.72,
                        "2025-03-01 00:00:00": 792.41,
                        "2025-04-01 00:00:00": 541.16,
                        "2025-05-01 00:00:00": 1011.46,
                        "2025-06-01 00:00:00": 895.49
                    },
                    "nivel": 4
                },
                {
                    "codigo": "001.01.05.0003",
                    "descricao": "Água mineral",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 1584.83,
                        "2025-02-01 00:00:00": 1069.44,
                        "2025-03-01 00:00:00": 1584.83,
                        "2025-04-01 00:00:00": 1082.32,
                        "2025-05-01 00:00:00": 2022.91,
                        "2025-06-01 00:00:00": 1790.99
                    },
                    "nivel": 4
                },
                {
                    "codigo": "001.02",
                    "descricao": "Receita com Serviços",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 1679.16,
                        "2025-02-01 00:00:00": 1133.09,
                        "2025-03-01 00:00:00": 1679.16,
                        "2025-04-01 00:00:00": 1146.75,
                        "2025-05-01 00:00:00": 2143.32,
                        "2025-06-01 00:00:00": 1897.5900000000001
                    },
                    "nivel": 2
                },
                {
                    "codigo": "001.02.01",
                    "descricao": "Encomendas para eventos",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 1679.16,
                        "2025-02-01 00:00:00": 1133.09,
                        "2025-03-01 00:00:00": 1679.16,
                        "2025-04-01 00:00:00": 1146.75,
                        "2025-05-01 00:00:00": 2143.32,
                        "2025-06-01 00:00:00": 1897.5900000000001
                    },
                    "nivel": 3
                },
                {
                    "codigo": "001.02.01.0001",
                    "descricao": "Buffet de café da manhã",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 433.94,
                        "2025-02-01 00:00:00": 292.82,
                        "2025-03-01 00:00:00": 433.94,
                        "2025-04-01 00:00:00": 296.35,
                        "2025-05-01 00:00:00": 553.89,
                        "2025-06-01 00:00:00": 490.39
                    },
                    "nivel": 4
                },
                {
                    "codigo": "001.02.01.0002",
                    "descricao": "Aniversários e confraternizações",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": 1245.22,
                        "2025-02-01 00:00:00": 840.27,
                        "2025-03-01 00:00:00": 1245.22,
                        "2025-04-01 00:00:00": 850.4,
                        "2025-05-01 00:00:00": 1589.43,
                        "2025-06-01 00:00:00": 1407.2
                    },
                    "nivel": 4
                },
                {
                    "codigo": "002",
                    "descricao": "Deduções da Receita",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -4664.98,
                        "2025-02-01 00:00:00": -3147.92,
                        "2025-03-01 00:00:00": -4664.98,
                        "2025-04-01 00:00:00": -3185.84,
                        "2025-05-01 00:00:00": -5954.490000000001,
                        "2025-06-01 00:00:00": -5271.8
                    },
                    "nivel": 1
                },
                {
                    "codigo": "002.01",
                    "descricao": "Impostos sobre Receita",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -3490.69,
                        "2025-02-01 00:00:00": -2355.51,
                        "2025-03-01 00:00:00": -3490.69,
                        "2025-04-01 00:00:00": -2383.89,
                        "2025-05-01 00:00:00": -4455.6,
                        "2025-06-01 00:00:00": -3944.76
                    },
                    "nivel": 2
                },
                {
                    "codigo": "002.01.01",
                    "descricao": "ICMS",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -1270.81,
                        "2025-02-01 00:00:00": -857.54,
                        "2025-03-01 00:00:00": -1270.81,
                        "2025-04-01 00:00:00": -867.87,
                        "2025-05-01 00:00:00": -1622.08,
                        "2025-06-01 00:00:00": -1436.11
                    },
                    "nivel": 3
                },
                {
                    "codigo": "002.01.01.0001",
                    "descricao": "ICMS sobre vendas de produtos",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -1270.81,
                        "2025-02-01 00:00:00": -857.54,
                        "2025-03-01 00:00:00": -1270.81,
                        "2025-04-01 00:00:00": -867.87,
                        "2025-05-01 00:00:00": -1622.08,
                        "2025-06-01 00:00:00": -1436.11
                    },
                    "nivel": 4
                },
                {
                    "codigo": "002.01.02",
                    "descricao": "PIS/COFINS",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -2219.88,
                        "2025-02-01 00:00:00": -1497.97,
                        "2025-03-01 00:00:00": -2219.88,
                        "2025-04-01 00:00:00": -1516.02,
                        "2025-05-01 00:00:00": -2833.52,
                        "2025-06-01 00:00:00": -2508.65
                    },
                    "nivel": 3
                },
                {
                    "codigo": "002.01.02.0001",
                    "descricao": "PIS",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -820.39,
                        "2025-02-01 00:00:00": -553.6,
                        "2025-03-01 00:00:00": -820.39,
                        "2025-04-01 00:00:00": -560.27,
                        "2025-05-01 00:00:00": -1047.17,
                        "2025-06-01 00:00:00": -927.11
                    },
                    "nivel": 4
                },
                {
                    "codigo": "002.01.02.0002",
                    "descricao": "COFINS",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -1399.49,
                        "2025-02-01 00:00:00": -944.37,
                        "2025-03-01 00:00:00": -1399.49,
                        "2025-04-01 00:00:00": -955.75,
                        "2025-05-01 00:00:00": -1786.35,
                        "2025-06-01 00:00:00": -1581.54
                    },
                    "nivel": 4
                },
                {
                    "codigo": "002.02",
                    "descricao": "Descontos e Devoluções",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -1174.29,
                        "2025-02-01 00:00:00": -792.41,
                        "2025-03-01 00:00:00": -1174.29,
                        "2025-04-01 00:00:00": -801.95,
                        "2025-05-01 00:00:00": -1498.89,
                        "2025-06-01 00:00:00": -1327.04
                    },
                    "nivel": 2
                },
                {
                    "codigo": "002.02.01",
                    "descricao": "Descontos promocionais",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -1174.29,
                        "2025-02-01 00:00:00": -792.41,
                        "2025-03-01 00:00:00": -1174.29,
                        "2025-04-01 00:00:00": -801.95,
                        "2025-05-01 00:00:00": -1498.89,
                        "2025-06-01 00:00:00": -1327.04
                    },
                    "nivel": 3
                },
                {
                    "codigo": "002.02.01.0001",
                    "descricao": "Descontos à vista",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -1174.29,
                        "2025-02-01 00:00:00": -792.41,
                        "2025-03-01 00:00:00": -1174.29,
                        "2025-04-01 00:00:00": -801.95,
                        "2025-05-01 00:00:00": -1498.89,
                        "2025-06-01 00:00:00": -1327.04
                    },
                    "nivel": 4
                },
                {
                    "codigo": "003",
                    "descricao": "Receita Líquida",
                    "tipo": "calculo (001 + 002)",
                    "formula": "001 + 002",
                    "valores": {
                        "2025-01-01 00:00:00": 9296.59,
                        "2025-02-01 00:00:00": 6273.3200000000015,
                        "2025-03-01 00:00:00": 9296.59,
                        "2025-04-01 00:00:00": 6348.9,
                        "2025-05-01 00:00:00": 11866.399999999998,
                        "2025-06-01 00:00:00": 10505.920000000002
                    },
                    "nivel": 1
                },
                {
                    "codigo": "005",
                    "descricao": "Lucro Bruto",
                    "tipo": "calculo (003 + 004)",
                    "formula": "003 + 004",
                    "valores": {
                        "2025-01-01 00:00:00": 9296.59,
                        "2025-02-01 00:00:00": 6273.3200000000015,
                        "2025-03-01 00:00:00": 9296.59,
                        "2025-04-01 00:00:00": 6348.9,
                        "2025-05-01 00:00:00": 11866.399999999998,
                        "2025-06-01 00:00:00": 10505.920000000002
                    },
                    "nivel": 1
                },
                {
                    "codigo": "006",
                    "descricao": "Despesas Operacionais",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -833.76,
                        "2025-02-01 00:00:00": -562.62,
                        "2025-03-01 00:00:00": -833.76,
                        "2025-04-01 00:00:00": -569.4,
                        "2025-05-01 00:00:00": -1064.23,
                        "2025-06-01 00:00:00": -942.21
                    },
                    "nivel": 1
                },
                {
                    "codigo": "006.02",
                    "descricao": "Despesas Administrativas",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -833.76,
                        "2025-02-01 00:00:00": -562.62,
                        "2025-03-01 00:00:00": -833.76,
                        "2025-04-01 00:00:00": -569.4,
                        "2025-05-01 00:00:00": -1064.23,
                        "2025-06-01 00:00:00": -942.21
                    },
                    "nivel": 2
                },
                {
                    "codigo": "006.02.02",
                    "descricao": "Serviços de terceiros",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -277.92,
                        "2025-02-01 00:00:00": -187.54,
                        "2025-03-01 00:00:00": -277.92,
                        "2025-04-01 00:00:00": -189.79999999999998,
                        "2025-05-01 00:00:00": -354.73999999999995,
                        "2025-06-01 00:00:00": -314.07
                    },
                    "nivel": 3
                },
                {
                    "codigo": "006.02.02.0001",
                    "descricao": "Contabilidade",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -224.29,
                        "2025-02-01 00:00:00": -151.35,
                        "2025-03-01 00:00:00": -224.29,
                        "2025-04-01 00:00:00": -153.17,
                        "2025-05-01 00:00:00": -286.28,
                        "2025-06-01 00:00:00": -253.46
                    },
                    "nivel": 4
                },
                {
                    "codigo": "006.02.02.0002",
                    "descricao": "Manutenção de equipamentos",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -53.63,
                        "2025-02-01 00:00:00": -36.19,
                        "2025-03-01 00:00:00": -53.63,
                        "2025-04-01 00:00:00": -36.63,
                        "2025-05-01 00:00:00": -68.46,
                        "2025-06-01 00:00:00": -60.61
                    },
                    "nivel": 4
                },
                {
                    "codigo": "006.02.03",
                    "descricao": "Despesas com infraestrutura",
                    "tipo": "sintetica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -555.84,
                        "2025-02-01 00:00:00": -375.08000000000004,
                        "2025-03-01 00:00:00": -555.84,
                        "2025-04-01 00:00:00": -379.6,
                        "2025-05-01 00:00:00": -709.49,
                        "2025-06-01 00:00:00": -628.14
                    },
                    "nivel": 3
                },
                {
                    "codigo": "006.02.03.0001",
                    "descricao": "Aluguel e condomínio",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -160.9,
                        "2025-02-01 00:00:00": -108.58,
                        "2025-03-01 00:00:00": -160.9,
                        "2025-04-01 00:00:00": -109.88,
                        "2025-05-01 00:00:00": -205.38,
                        "2025-06-01 00:00:00": -181.83
                    },
                    "nivel": 4
                },
                {
                    "codigo": "006.02.03.0002",
                    "descricao": "Água, luz e telefone",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -92.64,
                        "2025-02-01 00:00:00": -62.51,
                        "2025-03-01 00:00:00": -92.64,
                        "2025-04-01 00:00:00": -63.27,
                        "2025-05-01 00:00:00": -118.25,
                        "2025-06-01 00:00:00": -104.69
                    },
                    "nivel": 4
                },
                {
                    "codigo": "006.02.03.0003",
                    "descricao": "Materiais de limpeza",
                    "tipo": "analitica",
                    "formula": null,
                    "valores": {
                        "2025-01-01 00:00:00": -302.3,
                        "2025-02-01 00:00:00": -203.99,
                        "2025-03-01 00:00:00": -302.3,
                        "2025-04-01 00:00:00": -206.45,
                        "2025-05-01 00:00:00": -385.86,
                        "2025-06-01 00:00:00": -341.62
                    },
                    "nivel": 4
                },
                {
                    "codigo": "007",
                    "descricao": "Resultado Operacional",
                    "tipo": "calculo (005 + 006)",
                    "formula": "005 + 006",
                    "valores": {
                        "2025-01-01 00:00:00": 8462.83,
                        "2025-02-01 00:00:00": 5710.700000000002,
                        "2025-03-01 00:00:00": 8462.83,
                        "2025-04-01 00:00:00": 5779.5,
                        "2025-05-01 00:00:00": 10802.169999999998,
                        "2025-06-01 00:00:00": 9563.710000000003
                    },
                    "nivel": 1
                },
                {
                    "codigo": "009",
                    "descricao": "Resultado Antes do IR e CSLL",
                    "tipo": "calculo (007 + 008)",
                    "formula": "007 + 008",
                    "valores": {
                        "2025-01-01 00:00:00": 8462.83,
                        "2025-02-01 00:00:00": 5710.700000000002,
                        "2025-03-01 00:00:00": 8462.83,
                        "2025-04-01 00:00:00": 5779.5,
                        "2025-05-01 00:00:00": 10802.169999999998,
                        "2025-06-01 00:00:00": 9563.710000000003
                    },
                    "nivel": 1
                },
                {
                    "codigo": "011",
                    "descricao": "Resultado Líquido do Exercício",
                    "tipo": "calculo (009 + 010)",
                    "formula": "009 + 010",
                    "valores": {
                        "2025-01-01 00:00:00": 8462.83,
                        "2025-02-01 00:00:00": 5710.700000000002,
                        "2025-03-01 00:00:00": 8462.83,
                        "2025-04-01 00:00:00": 5779.5,
                        "2025-05-01 00:00:00": 10802.169999999998,
                        "2025-06-01 00:00:00": 9563.710000000003
                    },
                    "nivel": 1
                }
            ]
        }
    ],
    "timestamp_utc": "2025-06-21T21:49:21.041587Z",
    "timestamp_local": "2025-06-21T18:49:21.041587-03:00"
};
        
        // Obtém referências para os elementos HTML
        const viewSelect = document.getElementById('view-select');
        const viewTitle = document.getElementById('view-title');
        const tabela = document.getElementById('tabela');
        const thead = tabela.querySelector('thead');
        const tbody = tabela.querySelector('tbody');

        // --- Variáveis de estado para seleção ---
        let lastSelectedCell = null;
        let isMouseDown = false;
        let startCell = null;

        // --- Funções de Formatação e Utilitários ---
        function formatCurrency(value) {
            if (typeof value !== 'number' || isNaN(value) || value === null) {
                return '-';
            }
            try {
                return value.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL', minimumFractionDigits: 2, maximumFractionDigits: 2 });
            } catch (e) {
                console.error("Erro formatando moeda:", value, e);
                return String(value);
            }
        }

        function formatPeriodHeader(periodString) {
            try {
                const date = new Date(periodString);
                // Verifica se é uma data válida e não é uma data muito antiga (para evitar "Invalid Date")
                if (!isNaN(date) && date.getFullYear() > 1900) {
                    return date.toLocaleString('pt-BR', { month: 'short', year: 'numeric' }).replace('.', '');
                }
            } catch (e) {
                // console.warn(`Não foi possível formatar o período '${periodString}' como data. Usando string original.`);
            }
            return String(periodString).trim();
        }

        function getIndentClass(level) {
            if (typeof level !== 'number' || isNaN(level) || level < 1) return 'indent-level-0';
            return `indent-level-${Math.max(0, level - 1)}`;
        }

        // Função auxiliar para obter o código do pai (ex: de "1.1.1" retorna "1.1")
        function getParentCode(accountCode) {
            if (typeof accountCode === 'string') {
                const parts = accountCode.split('.');
                if (parts.length > 1) {
                    return parts.slice(0, -1).join('.');
                }
            }
            return null; // Retorna null para contas de nível superior ou inválidas
        }

        // --- Funções de Interação da Tabela (Seleção) ---
        function getCellPosition(cell) {
            return {
                row: parseInt(cell.getAttribute('data-row')),
                col: parseInt(cell.getAttribute('data-col'))
            };
        }

        function selectCellsInRange(start, end) {
            const allCells = tabela.querySelectorAll('.planilha-valor');
            allCells.forEach(cell => {
                const { row, col } = getCellPosition(cell);
                const inRowRange = row >= Math.min(start.row, end.row) && row <= Math.max(start.row, end.row);
                const inColRange = col >= Math.min(start.col, end.col) && col <= Math.max(start.col, end.col);
                cell.classList.toggle('cell-selecionada', inRowRange && inColRange);
            });
        }

        function clearSelection() {
            tabela.querySelectorAll('.cell-selecionada').forEach(cell => cell.classList.remove('cell-selecionada'));
            thead.querySelectorAll('.cabecalho-selecionado').forEach(th => th.classList.remove('cabecalho-selecionado'));
            tbody.querySelectorAll('.indicador-selecionado').forEach(td => td.classList.remove('indicador-selecionado'));
        }

        // --- NOVA FUNÇÃO PARA EXPANDIR/COLAPSAR ---
        function toggleRowVisibility(targetRow) {
            const isCurrentlyCollapsed = targetRow.classList.contains('collapsed'); // Estado ANTES do toggle
            const targetAccountCode = targetRow.dataset.accountCode;
            const targetLevel = parseInt(targetRow.dataset.level);

            // 1. Alterna o estado da linha clicada
            targetRow.classList.toggle('collapsed');
            targetRow.classList.remove('expanded'); 
            
            // 2. Atualiza a seta visualmente
            const arrow = targetRow.querySelector('.toggle-arrow');
            if (arrow) {
                arrow.innerHTML = isCurrentlyCollapsed ? '&#9660;' : '&#9658;'; 
            }

            const allRows = Array.from(tbody.children); 
            let foundTargetRow = false;

            for (const currentRow of allRows) {
                // Pula as linhas até encontrar a linha alvo
                if (!foundTargetRow) {
                    if (currentRow === targetRow) {
                        foundTargetRow = true;
                    }
                    continue; 
                }

                const currentAccountCode = currentRow.dataset.accountCode;
                const currentLevel = parseInt(currentRow.dataset.level);
                
                const isDescendantOfTarget = currentAccountCode.startsWith(targetAccountCode + '.');
                
                if (!isDescendantOfTarget || currentLevel <= targetLevel) {
                    break;
                }

                let willBeHiddenByParent = targetRow.classList.contains('collapsed'); 
                
                if (!willBeHiddenByParent) { 
                    let parentChainVisible = true;
                    let checkCode = currentAccountCode; 
                    
                    while (checkCode && checkCode !== targetAccountCode) { 
                        const directParentCode = getParentCode(checkCode);
                        if (!directParentCode) { 
                            parentChainVisible = false; 
                            break;
                        }
                        const parentDOMRow = tbody.querySelector(`tr[data-account-code="${directParentCode}"]`);
                        
                        if (parentDOMRow && (parentDOMRow.classList.contains('hidden-by-collapse') || parentDOMRow.classList.contains('collapsed'))) {
                            parentChainVisible = false;
                            break;
                        }
                        checkCode = directParentCode;
                    }
                    willBeHiddenByParent = !parentChainVisible; 
                }

                if (willBeHiddenByParent) { 
                    currentRow.classList.add('hidden-by-collapse');
                    if (currentRow.classList.contains('collapsible-row')) {
                        currentRow.classList.add('collapsed');
                        const nestedArrow = currentRow.querySelector('.toggle-arrow');
                        if (nestedArrow) nestedArrow.innerHTML = '&#9658;'; 
                    }
                } else {
                    currentRow.classList.remove('hidden-by-collapse');
                    if (currentRow.classList.contains('collapsible-row')) {
                        const nestedArrow = currentRow.querySelector('.toggle-arrow');
                        if (nestedArrow) {
                            nestedArrow.innerHTML = currentRow.classList.contains('collapsed') ? '&#9658;' : '&#9660;';
                        }
                    }
                }
            }
        }


        // --- Função Principal para Renderizar a Tabela ---
        function renderTable(viewIndex) {
            // Limpa cabeçalho e corpo atuais da tabela
            thead.innerHTML = '';
            tbody.innerHTML = '';
            viewTitle.textContent = 'Selecione uma Visão para Visualizar...';

            // Verifica se não há dados de visões calculadas
            if (!calculatedViewsData || !calculatedViewsData.calculated_views || calculatedViewsData.calculated_views.length === 0) {
                const headerRow = thead.insertRow();
                const thDescricao = document.createElement('th');
                thDescricao.textContent = 'Descrição';
                headerRow.appendChild(thDescricao);
                // Adiciona uma mensagem no corpo da tabela para clareza
                const noDataRow = tbody.insertRow();
                const noDataCell = noDataRow.insertCell();
                noDataCell.colSpan = 2; // Abrange as colunas Descrição e pelo menos uma de período
                noDataCell.textContent = "Nenhuma visão calculada disponível. Por favor, processe os dados primeiro.";
                noDataCell.style.textAlign = 'center';
                noDataCell.style.padding = '20px';
                return;
            }

            // Verifica se o índice da visão é válido para os dados carregados
            if (viewIndex === "" || viewIndex < 0 || viewIndex >= calculatedViewsData.calculated_views.length) {
                // Se inválido ou vazio (seleção inicial ou "-- Selecione --"), exibe o cabeçalho básico
                const headerRow = thead.insertRow();
                const thDescricao = document.createElement('th');
                thDescricao.textContent = 'Descrição';
                headerRow.appendChild(thDescricao);
                // Exibe a mensagem padrão para seleção
                viewTitle.textContent = 'Selecione uma Visão para Visualizar...';
                return;
            }

            // Pega a visão calculada selecionada do array
            const selectedView = calculatedViewsData.calculated_views[viewIndex];
            console.log("Renderizando visão:", selectedView); // Para depuração

            // Atualiza o subtítulo com o nome da visão
            viewTitle.textContent = `${selectedView.plan_name} (DataSource: ${selectedView.data_source_name})`;

            // Monta a ÚNICA linha de cabeçalho com os títulos das colunas
            const headerRow = thead.insertRow();

            // Cabeçalho para a coluna de Descrição (agora é a primeira coluna visível)
            const thDescricao = document.createElement('th');
            thDescricao.textContent = 'Descrição';
            thDescricao.classList.add('indicador-col'); // Usa a classe para estilização e como marcador de cabeçalho de linha
            headerRow.appendChild(thDescricao);

            // Adiciona colunas de cabeçalho para cada período (com listeners de seleção de coluna)
            selectedView.periodos.forEach((periodString, colIndex) => {
                const th = document.createElement('th');
                th.textContent = formatPeriodHeader(periodString);
                th.style.textAlign = 'center';
                th.classList.add('cabecalho-ano'); // Classe para estilo/marcação de seleção
                th.setAttribute('data-col', colIndex); // Marca com índice da coluna

                // Event listener para seleção de coluna (Ctrl/Cmd e Shift)
                th.addEventListener('click', function(e) {
                    const clickedCol = parseInt(this.getAttribute('data-col'));
                    const allPeriodHeaders = Array.from(thead.querySelectorAll('th[data-col]'));

                    if (!e.ctrlKey && !e.shiftKey) { // Clique simples: limpa e seleciona
                        clearSelection();
                        this.classList.add('cabecalho-selecionado');
                        tbody.querySelectorAll(`td.planilha-valor[data-col="${clickedCol}"]`).forEach(cell => cell.classList.add('cell-selecionada'));
                    } else if (e.ctrlKey || e.metaKey) { // Ctrl/Cmd+clique: toggle seleção
                        this.classList.toggle('cabecalho-selecionado');
                        tbody.querySelectorAll(`td.planilha-valor[data-col="${clickedCol}"]`).forEach(cell => cell.classList.toggle('cell-selecionada'));
                    } else if (e.shiftKey) { // Shift+clique: seleção de faixa
                        let lastSelectedCol = -1;
                        // Encontra a última coluna de período selecionada explicitamente
                        for (let i = 0; i < allPeriodHeaders.length; i++) {
                            if (allPeriodHeaders[i].classList.contains('cabecalho-selecionado')) {
                                lastSelectedCol = parseInt(allPeriodHeaders[i].getAttribute('data-col'));
                                break;
                            }
                        }
                        // Se nenhuma estava selecionada, começa da primeira coluna de período
                        if (lastSelectedCol === -1 && allPeriodHeaders.length > 0) {
                            lastSelectedCol = parseInt(allPeriodHeaders[0].getAttribute('data-col'));
                        } else if (lastSelectedCol === -1) { // Se não há colunas de período
                            lastSelectedCol = clickedCol;
                        }

                        const startCol = Math.min(lastSelectedCol, clickedCol);
                        const endCol = Math.max(lastSelectedCol, clickedCol);

                        allPeriodHeaders.forEach(header => {
                            const headerCol = parseInt(header.getAttribute('data-col'));
                            if (headerCol >= startCol && headerCol <= endCol) {
                                header.classList.add('cabecalho-selecionado');
                            } else {
                                header.classList.remove('cabecalho-selecionado');
                            }
                        });

                        tbody.querySelectorAll('tr').forEach(row => {
                            row.querySelectorAll('td.planilha-valor').forEach(cell => {
                                const cellCol = parseInt(cell.getAttribute('data-col'));
                                if (cellCol >= startCol && cellCol <= endCol) {
                                    cell.classList.add('cell-selecionada');
                                } else {
                                    cell.classList.remove('cell-selecionada');
                                }
                            });
                        });
                    }
                    e.stopPropagation(); // Impede que o clique se propague para outros listeners
                });

                headerRow.appendChild(th);
            });


            // Monta o corpo da tabela (linhas para cada conta)
            selectedView.accounts.forEach((account, rowIndex) => {
                const dataRow = tbody.insertRow();
                // Adiciona atributos de dados para hierarquia e identificação (para o toggle)
                dataRow.dataset.accountCode = account.codigo;
                dataRow.dataset.level = account.nivel;
                // Adiciona data-parent-code apenas se a conta não for de nível 1
                if (account.nivel > 1) {
                    dataRow.dataset.parentCode = getParentCode(account.codigo);
                }

                // Adiciona classes de estilo à linha inteira com base no tipo da conta
                if (account.tipo === 'sintetica') {
                    dataRow.classList.add('conta-sintetica');
                } else if (account.tipo === 'analitica') {
                    dataRow.classList.add('conta-analitica');
                } else if (typeof account.tipo === 'string' && account.tipo.substring(0, 7) === 'calculo') {
                    dataRow.classList.add('conta-calculo');
                }

                // Célula para a Descrição (agora também o "cabeçalho de linha" para seleção)
                const descricaoCell = dataRow.insertCell();
                const nivel = typeof account.nivel === 'number' && !isNaN(account.nivel) ? account.nivel : 1;
                descricaoCell.classList.add('account-descricao', getIndentClass(nivel));
                descricaoCell.classList.add('indicador-col'); // Marca a célula de descrição como indicador de linha
                descricaoCell.setAttribute('data-row', rowIndex); // Marca com o índice da linha

                // Implementação do toggle SOMENTE para contas sintéticas
                if (account.tipo === 'sintetica') { 
                    const toggleArrow = document.createElement('span');
                    toggleArrow.classList.add('toggle-arrow');
                    toggleArrow.innerHTML = '&#9660;'; // Usa innerHTML para renderizar o símbolo corretamente
                    descricaoCell.prepend(toggleArrow); // Adiciona a seta antes do texto
                    dataRow.classList.add('collapsible-row'); // Marca a linha como colapsável (por padrão, é expandida)

                    // Listener de clique diretamente na seta de toggle
                    toggleArrow.addEventListener('click', function(e) {
                        e.stopPropagation(); // Impede a propagação do clique para a célula pai (descricaoCell)
                        toggleRowVisibility(dataRow); // Chama a função de toggle
                    });
                }
                // Cria um span para o texto da descrição para que ele não se misture com a seta
                const descriptionTextSpan = document.createElement('span');
                descriptionTextSpan.textContent = account.descricao;
                descricaoCell.append(descriptionTextSpan); // Adiciona o span com o texto da descrição da conta

                // Event listener para seleção de linha (Ctrl/Cmd e Shift)
                // Este listener agora lida APENAS com a seleção, sem interferir no toggle
                descricaoCell.addEventListener('click', function(e) {
                    const clickedRow = parseInt(this.getAttribute('data-row'));
                    const allRowHeaders = Array.from(tbody.querySelectorAll('td.indicador-col')); // Todas as células de descrição/indicador

                    if (!e.ctrlKey && !e.shiftKey) { // Clique simples
                        clearSelection();
                        this.classList.add('indicador-selecionado');
                        dataRow.querySelectorAll('.planilha-valor').forEach(cell => cell.classList.add('cell-selecionada'));
                    } else if (e.ctrlKey || e.metaKey) { // Ctrl/Cmd+clique
                        this.classList.toggle('indicador-selecionado');
                        dataRow.querySelectorAll('.planilha-valor').forEach(cell => cell.classList.toggle('cell-selecionada'));
                    } else if (e.shiftKey) { // Shift+clique
                        let lastSelectedRow = -1;
                        for (let i = 0; i < allRowHeaders.length; i++) {
                            if (allRowHeaders[i].classList.contains('indicador-selecionado')) {
                                lastSelectedRow = parseInt(allRowHeaders[i].getAttribute('data-row'));
                                break;
                            }
                        }
                        if (lastSelectedRow === -1 && allRowHeaders.length > 0) {
                            lastSelectedRow = parseInt(allRowHeaders[0].getAttribute('data-row'));
                        } else if (lastSelectedRow === -1) { // Se não há linhas de cabeçalho
                            lastSelectedRow = clickedRow;
                        }

                        const startRow = Math.min(lastSelectedCol, clickedCol);
                        const endCol = Math.max(lastSelectedCol, clickedCol);

                        allRowHeaders.forEach(header => {
                            const headerRow = parseInt(header.getAttribute('data-row'));
                            if (headerRow >= startRow && headerRow <= endRow) {
                                header.classList.add('indicador-selecionado');
                            } else {
                                header.classList.remove('indicador-selecionado');
                            }
                        });

                        tbody.querySelectorAll('tr').forEach(row => {
                            const rowIdx = parseInt(row.querySelector('td.indicador-col').getAttribute('data-row'));
                            if (rowIdx >= startRow && rowIdx >= endRow) { // Corrigido aqui: deve ser <= endRow
                                row.querySelectorAll('.planilha-valor').forEach(cell => cell.classList.add('cell-selecionada'));
                            } else {
                                row.querySelectorAll('.planilha-valor').forEach(cell => cell.classList.remove('cell-selecionada'));
                            }
                        });
                    }
                });

                dataRow.appendChild(descricaoCell);


                // Adiciona células para os valores de cada período (com listeners de seleção de célula)
                selectedView.periodos.forEach((periodString, periodIndex) => {
                    const valueCell = dataRow.insertCell();
                    const value = account.valores[periodString];
                    let formattedValue = formatCurrency(value);

                    valueCell.textContent = formattedValue;
                    valueCell.classList.add('value-cell');
                    valueCell.classList.add('planilha-valor'); // Importante para seleção de área
                    valueCell.setAttribute('data-row', rowIndex);
                    valueCell.setAttribute('data-col', periodIndex); // ColIndex para a célula de valor


                    // Event listeners para seleção de célula individual/faixa
                    valueCell.addEventListener('mousedown', function(e) {
                        isMouseDown = true;
                        if (e.ctrlKey || e.metaKey) { // Ctrl/Cmd+clique: toggle seleção individual
                            this.classList.toggle('cell-selecionada');
                            lastSelectedCell = this;
                        } else if (e.shiftKey && lastSelectedCell) { // Shift+clique: seleção de faixa
                            selectCellsInRange(getCellPosition(lastSelectedCell), getCellPosition(this));
                        } else { // Clique simples: limpa e seleciona
                            clearSelection();
                            this.classList.add('cell-selecionada');
                            lastSelectedCell = this;
                        }
                        startCell = this;
                        e.preventDefault(); // Impede seleção de texto padrão do navegador
                        e.stopPropagation(); // Impede propagação para listeners de linha/coluna
                    });

                    valueCell.addEventListener('mouseover', function(e) {
                        if (isMouseDown && startCell) {
                            selectCellsInRange(getCellPosition(startCell), getCellPosition(this));
                        }
                    });

                    valueCell.addEventListener('mouseup', function() {
                        isMouseDown = false;
                        startCell = null;
                    });


                    dataRow.appendChild(valueCell);
                });

                tbody.appendChild(dataRow);
            });

            // Adiciona um listener global para limpar a seleção ao clicar fora da tabela
            document.addEventListener('mousedown', function(e) {
                if (!tabela.contains(e.target) && !viewSelect.contains(e.target)) {
                    clearSelection();
                }
            });
            document.addEventListener('mouseup', () => {
                isMouseDown = false;
                startCell = null;
            });
        }

        // --- Inicialização ---

        // Popular o dropdown de seleção de visão
        if (calculatedViewsData && calculatedViewsData.calculated_views && calculatedViewsData.calculated_views.length > 0) {
            const defaultOption = document.createElement('option');
            defaultOption.value = "";
            defaultOption.textContent = "-- Selecione --";
            viewSelect.appendChild(defaultOption);

            calculatedViewsData.calculated_views.forEach((view, index) => {
                const option = document.createElement('option');
                option.value = index;
                option.textContent = `${view.plan_name} (com ${view.data_source_name})`;
                viewSelect.appendChild(option);
            });
            // Opcional: Seleciona automaticamente a primeira visão se houver apenas uma, ou deixa em branco para seleção
            if (calculatedViewsData.calculated_views.length === 1) {
                viewSelect.value = 0;
                renderTable(0); // Renderiza a primeira visão por padrão
            } else {
                renderTable(""); // Renderiza o estado inicial "Selecione uma Visão..."
            }
        } else {
            const option = document.createElement('option');
            option.value = "";
            option.textContent = "Nenhuma visão calculada encontrada.";
            viewSelect.appendChild(option);
            viewSelect.disabled = true; // Desabilita o dropdown se não há dados
            // Renderiza a tabela para mostrar a mensagem de "nenhum dado";
            renderTable("");
        }

        // Adiciona listener para o evento de mudança no dropdown
        viewSelect.addEventListener('change', (event) => {
            const selectedValue = event.target.value;
            if (selectedValue !== "") {
                renderTable(parseInt(selectedValue));
            } else {
                renderTable("");
            }
        });

        // Adiciona listener global para desabilitar a seleção de texto do navegador
        document.addEventListener('selectstart', function(e){ e.preventDefault(); });

    </script>
</body>
</html>